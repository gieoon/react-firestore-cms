{"version":3,"sources":["../../src/loading.js","../../src/textEditor.js","../../src/commonFunctions.js","../../src/constants.js","../../src/webpageEditor.js","../../src/UpdatePage.js","../../src/index.js","../../src/config.js","../../src/assets/profile.png","App.js","index.js"],"names":["Loading","loadingTexts","className","loading","RichTextEditor","value","files","showDropdown","componentDidUpdate","this","props","initialValue","prevProps","render","state","onChange","toolbarConfig","display","INLINE_STYLE_BUTTONS","label","style","BLOCK_TYPE_DROPDOWN","BLOCK_TYPE_BUTTONS","customControls","onClick","console","key","editorState","contentStateWithEntity","url","file","class","entityKey","newEditorState","currentContent","newValue","RichUtils","React","firebaseDate2DisplayDate","firebaseDate","Date","STORAGE_ROOT","WebpageEditor","setFrameLoaded","useState","useEffect","id","height","width","contentDidMount","quills","UpdatePage","frameLoaded","highlightEditable","interval","setInterval","addEditButton","head","getIframe","link","clearInterval","parent","document","Array","el","dw","d","editorContainer","d2","d3","e","saveClicked","cancelClicked","createEditInput","parentElement","getCssSelector","a","currentText","dbObj","name","surname","description","jobs","careers","title","duration","details","volunteer_work","qualifications1","qualifications2","qualifications3","text","start","end","sections","val","extractElementContent","createNestedObj","saveWebsiteContent","obj","path","db","err","toolbarOptions","m","regexp","RegExp","quill","modules","toolbar","theme","root","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","SectionContent","setShowingAdditionalDate","entry","src","effect","alt","controls","type","dangerouslySetInnerHTML","__html","content","setShowingEdit","setShowingNew","setNewAudio","setNewImages","setNewFiles","setNewDate","ad","setAdditionalDate","setNewTitle","setNewText","setRteInitTitle","setRteInitContent","setShowingDeleteDialog","children","setStorage","provider","setCurrentEmail","user","setCurrentUser","setLoginComplete","setCurrentUid","LogIn","authTest","init","loginComplete","lastLogin","merge","loadWebpageDataFromUid","pageData","setPageData","setWebpageEditable","setEditType","loadAllSectionData","setCurrentSection","doc","forceUpdate","useCallback","updatePageData","data","promises","out","section","loadSectionData","Promise","snapshot","change","p","saveImage","fileObj","metaData","customMetadata","currentEmail","getStoragePath","storageRef","storage","saveAudio","saveMiscellaneous","filename","projectName","saveNew","setShowSaving","sectionName","imgObjs","i","newImages","imgObj","audioObjs","newAudio","audioObj","fileObjs","newFiles","toLocaleDateString","showingAdditionalDate","showingEdit","hideShowingNew","deleteStoredObject","downloadUrl","charSet","rel","href","sizes","currentUid","webpageEditable","editType","backgroundColor","selectedSectionIndex","setSelectedSectionIndex","updateSelectedSectionIndex","currentUser","showingNew","Object","currentSection","htmlFor","URL","localFile","hidden","accept","newImage","removeUploadedImg","f","audio","removeUploadedAudio","newFile","download","selected","dateFormat","showSaving","showingDeleteDialog","deleteSectionContent","MyWebsite","padding","margin","map","job","lineHeight","justifyContent","flexWrap","career","borderRadius","border","App","ReactDOM","getElementById"],"mappings":"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","file":"static/js/main.e46d0b51.chunk.js","sourcesContent":["import React from 'react';\nimport './loading.scss';\n\nexport default function Loading({\n    loading,\n    loadingTexts,\n}){\n    // console.log(\"loading: \", loading)\n    //TODO update the loading text as it comes around.\n\n    return(\n        // <div className=\"Loading\"></div>\n        <div>\n            <div className={\"Loading \" + (loading ? \"show\" : \"\")}>\n                <div className=\"double-bounce1\"></div>\n                <div className=\"double-bounce2\"></div>\n            </div>\n            <div className={\"Loading-overlay \" + (loading ? \"show\" : \"\")}></div>\n        </div>\n    );\n}\n","import React from 'react';\nimport RichTextEditor, {EditorValue} from 'react-rte';\nimport {RichUtils, EditorState} from 'draft-js'\nimport {X} from 'react-feather';\n\n// https://github.com/sstur/react-rte/blob/master/src/EditorDemo.js\n// https://github.com/sstur/react-rte/blob/8c81622706a5f8856d39497bf33f92a97e9664fc/src/lib/EditorValue.js#L42\n\n// Demonstrates how to add links\n// https://codepen.io/Kiwka/pen/ZLvPeO\n\nexport default class RichEditor extends React.Component {\n    editorValue = RichTextEditor.createEmptyValue();\n    state = {\n        value: this.editorValue,\n        files: this.props.files,\n        showDropdown: false,\n    }\n    \n    componentDidUpdate(prevProps, prevState, snapshot){\n      if(this.props.initialValue !== prevProps.initialValue){\n        this.setState({\n          value: RichTextEditor.createValueFromString(this.props.initialValue, 'html'),\n        });\n      }\n    }\n    \n    onChange = (value) => {\n        this.setState({value});\n        if (this.props.onChange) {\n          // Send the changes up to the parent component as an HTML string.\n          // This is here to demonstrate using `.toString()` but in a real app it\n          // would be better to avoid generating a string on each change.\n          // console.log('value.tostring(): ', value.toString('html'));\n          this.props.onChange(\n            value.toString('html')\n          );\n        }\n    };\n    \n    render () {\n      // console.log(this.state.value);\n\n        const toolbarConfig = {\n            display: [\n                'INLINE_STYLE_BUTTONS', \n                'BLOCK_TYPE_BUTTONS', \n                'BLOCK_TYPE_DROPDOWN', \n                'LINK_BUTTONS', \n                //'HISTORY_BUTTONS'\n            ],\n            INLINE_STYLE_BUTTONS: [\n              {label: 'Bold', style: 'BOLD', className: 'custom-css-class'},\n              {label: 'Italic', style: 'ITALIC'},\n              {label: 'Underline', style: 'UNDERLINE'},\n            ],\n            BLOCK_TYPE_DROPDOWN: [\n              {label: 'Normal', style: 'unstyled'},\n              {label: 'Small Title', style: 'header-three'},\n              {label: 'Medium Title', style: 'header-two'},\n              {label: 'Large Title', style: 'header-one'},\n            ],\n            BLOCK_TYPE_BUTTONS: [\n              {label: 'UL', style: 'unordered-list-item'},\n              {label: 'OL', style: 'ordered-list-item'}\n            ]\n        };\n\n        return (\n          <RichTextEditor\n            value={this.state.value}\n            onChange={this.onChange}\n            toolbarConfig={toolbarConfig}\n            customControls={[\n              (setValue, getValue, editorState) => {\n                return this.props.files\n                  ? <div className=\"link-file\" onClick={()=>{\n                      console.log('Link to file clicked: ', this.props.files);\n                      // console.log(window.getSelection().toString());\n                      this.setState({\n                        showDropdown: !this.state.showDropdown,\n                      });\n                      // setValue('custom-file-link', this.state.value);\n                    }} style={{display: this.props.files.length ? \"inline-block\" : \"none\"}}>\n                      { this.state.showDropdown \n                        ? <X /> \n                        : \"Link to a file\"\n                      }\n                      <div className={\"link-file-dropdown \" + (this.state.showDropdown ? \"showing\" : \"\")}>\n                        {\n                          this.props.files.map((file, i)=>(\n                            <div key={\"link-file-\"+i} onClick={()=>{\n                              console.log('file selected: ', file);\n\n                              var selectionState = editorState.getSelection();\n                              var anchorKey = selectionState.getAnchorKey();\n                              var contentState = editorState.getCurrentContent();\n                              const contentStateWithEntity = contentState.createEntity(\n                                'LINK',\n                                'MUTABLE',\n                                {url: `file:${file.id}`, //file.name\n                                class: \"file-link\"\n                                }\n                              )\n                              const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n                              const newEditorState = EditorState.set(editorState, {\n                                currentContent: contentStateWithEntity,\n                              });\n\n                              const newValue = new EditorValue(\n                                RichUtils.toggleLink(\n                                  newEditorState,\n                                  newEditorState.getSelection(),\n                                  entityKey,\n                                'html'),\n                              )\n\n                              this.setState({\n                                value: newValue\n                              })\n                              this.props.onChange(\n                                newValue.toString('html')\n                              );\n\n                            }}>\n                              <span>{file.name}</span>\n                            </div>\n                          ))\n                        }\n                      </div>\n                  </div>\n                  : \"\"\n              },\n            ]}\n          />\n        );\n    }\n}\n\n","// convert firebase date format to a display date\nexport const firebaseDate2DisplayDate = (firebaseDate) => {\n    // console.log('converting: ', firebaseDate.seconds * 1000)\n    if(!firebaseDate || !firebaseDate.seconds) return \"\";\n    const out = new Date(firebaseDate.seconds * 1000).toLocaleDateString(\"en-nz\");\n    // console.log(out);\n    return out;\n}\n\nexport const getCMSStoragePath = (projectName, type, filename) => {\n    // return currentEmail + \"/\" + type + \"/\" + filename + \"-\" + Date.now();\n    return \"custom/\" + projectName + \"/cms/\" + type + \"/\" + Date.now() + \"-\" + filename;\n}\n\nexport const getWebsiteContentsStoragePath = (projectName, type, filename) => {\n    // return currentEmail + \"/\" + type + \"/\" + filename + \"-\" + Date.now();\n    return \"custom/\" + projectName + \"/content/\" + type + \"/\" + Date.now() + \"-\" + filename;\n}\n","export const ENVIRONMENT = \n    \"DEVELOP\"; \n    // \"PRODUCTION\";\n\nexport const SHOW_HUMAN_FEEDBACK = ENVIRONMENT === \"DEVELOP\";\nexport const DB_VERSION = ENVIRONMENT === \"DEVELOP\" \n    ? \"DEBUG_\" \n    : \"LIVE_\"; \n\nexport const COLLECTION__CMS = DB_VERSION + \"CMS\";\nexport const STORAGE_ROOT = 'https://firebasestorage.googleapis.com';","/* DEPRECATED, was using this to edit cross-domain and display locally via iframes. */\n\nimport React, {useEffect, useState} from 'react';\nimport Frame from 'react-frame-component';\n// Edits webpages based on a list of id's.\nexport default function WebpageEditor({\n    // pageData, \n    children,\n    setFrameLoaded,\n}){\n    const [editable, setEditable] = useState();\n    \n    useEffect(()=>{\n        // Client has built in script that listens to 'highlight' event.\n        // This will trigger code.\n        // TODO Turn this into a npm library.\n        \n        // const editableElements = Array.from(\n        //     iframe.querySelectorAll('.cp-editable')\n        // );\n\n        // console.log(\"editableElements: \", editableElements);\n    }, []);\n\n    // const iframeLoadComplete = () => {\n    //     const iframe = document.querySelector('iframe').contentWindow;\n    //     iframe.postMessage('startEdit', '*' /*window.location.href*/);\n    // }\n\n    return(\n        // <div className=\"WebpageEditor\">\n            // <iframe src={pageData.liveURL} onLoad={()=>{iframeLoadComplete()}} width=\"100%\" height=\"100%\" title=\"Client Website\" />\n            <Frame\n                id=\"editingFrame\"\n                height=\"100%\"\n                width=\"100%\"\n                // initialContent='<!DOCTYPE html><html><head><style>body:{margin:0;}</style></head><body></body></html>'\n                contentDidMount={()=>{\n                    console.log('Frame mounted!!!: ');\n                    setFrameLoaded(true);\n                }}\n            >\n                {children}\n            </Frame>\n\n        // </div>\n    )\n}","import React, {useEffect, useState, ReactDOM} from 'react';\n// import {useLocation} from 'react-router-dom';\n// This is shared code for all CMS listeners.\n// Listens to events from login.<domain-name>.craftie.xyz, \n// Edits the page after events are received.\nimport Quill from 'quill';\n// import ReactQuill from 'react-quill';\n// import 'react-quill/dist/quill.snow.css';\nimport getCssSelector from 'css-selector-generator';\nimport { getDefaultKeyBinding } from 'draft-js';\n\nconst quills = {};\n\nexport default function UpdatePage({\n    projectName,\n    db,\n    frameLoaded,\n}){\n    \n    useEffect(()=>{\n        if(frameLoaded){\n            highlightEditable();\n\n            var interval = setInterval(() => {\n                addEditButton();\n            }, 1500);\n\n            var head = getIframe().head;\n            var link = getIframe().createElement(\"link\");\n            link.type = \"text/css\";\n            link.rel = \"stylesheet\";\n            link.href = \"https://cdn.quilljs.com/1.3.6/quill.snow.css\";\n            head.appendChild(link);\n            return () => { \n                head.removeChild(link); \n                console.log('CLEARING INTERVAL');\n                clearInterval(interval);\n            }\n        }\n    }, [frameLoaded]);\n\n    const getIframe = () => {\n        var parent = document.querySelector('#editingFrame');\n        if(parent)\n            return parent.contentDocument;\n        return undefined;\n    }\n\n    const addEditButton = () => {\n        const elements = Array.from(\n            getIframe().querySelectorAll('.cp-editable')\n        );\n        // console.log(\"editable elements: \", elements[2]);\n        for(var el of elements){\n            // console.log('el.querySelector(.cp-editable-btn): ', el.querySelector('.cp-editable-btn') === undefined);\n\n            if(!el.querySelector('.cp-editable-btn')){\n                console.log('Adding button');\n                const dw = getIframe().createElement('div');\n                dw.classList.add(\"cp-editable-btn-wrapper\");\n                // console.log('Adding edit button to element: #', el, el.querySelector('.cp-editable-btn'));\n                const d = getIframe().createElement('div');\n                const editorContainer = getIframe().createElement('div');\n                d.textContent = \"Edit\";\n                // const img = document.createElement('img');\n                // img.src = \"\";\n                d.classList.add('cp-editable-btn');\n                editorContainer.classList.add('editor');\n                \n                const d2 = getIframe().createElement('div');\n                d2.textContent = \"Save\";\n                d2.classList.add('cp-editable-save-btn');\n                \n\n                const d3 = getIframe().createElement('div');\n                d3.textContent = \"Cancel\";\n                d3.classList.add('cp-editable-cancel-btn');\n                \n                d2.onclick = (e) => {\n                    saveClicked(e);\n                }\n\n                d3.onclick = (e) => {\n                    cancelClicked();\n                }\n                \n                d.onclick = (e) => {\n                    createEditInput(e);\n                }\n                el.appendChild(editorContainer);\n                dw.appendChild(d);\n                dw.appendChild(d2);\n                dw.appendChild(d3);\n                el.appendChild(dw);\n            }\n\n        }\n    }\n\n    const cancelClicked = (e) => {\n        var parentElement = e.target.closest('.cp-editable');\n        parentElement.classList.toggle('editing');\n        console.log('Cancel pressed')\n        console.log(quills[getCssSelector(parentElement)].getText());\n        // quills[getCssSelector(parentElement)].setText(\"\");\n        // Manually hide\n        parentElement.querySelector('.ql-toolbar').style.display = \"none\";\n        parentElement.querySelector('.ql-container').style.display = \"none\";\n\n        // quills[getCssSelector(parentElement)].disable();//enable(false);\n        // delete quills[getCssSelector(parentElement)];\n        parentElement.textContent = quills[getCssSelector(parentElement)].getText();\n        console.log(\"parentElement.textContent: \", parentElement.textContent);\n    }\n\n    const saveClicked = async (e) => {\n        var parentElement = e.target.closest('.cp-editable');\n        parentElement.classList.toggle('editing');\n\n        // Update local DOM\n        // var quill = quills[getCssSelector(parentElement)];\n        var currentText = getIframe().querySelector('.ql-editor').textContent;//Not working => quill.getText();\n        console.log('got text: ', currentText);\n\n        parentElement.textContent = currentText;\n\n        // Save all to DB\n        \n        // Creates id.\n        // Converts hyphens to child component.\n        // Converts numbers to sections of an array.\n        //TODO testing data.\n        const data = {\n            name: \"Jason\",\n            surname: \"Briggs\",\n            description: \"A paragraph that can be changed by pressing the edit button on the bottom right.\",\n            jobs: [\n              \"Software Engineer\",\n              \"Automation Tester\",\n              \"Developer Operations\",\n              \"Marketing & Sales Coordinator\",\n              \"Test Analyst\"\n            ],\n            careers: [\n              {\n                title: \"Automation Testing\",\n                duration: 2,\n              },\n              {\n                title: \"Junior Software Developer\",\n                duration: 5\n              },\n              {\n                title: \"Senior Software Developer\",\n                duration: 10,\n              }\n            ],\n            details: {\n                volunteer_work: \"Working at the Orphanage\",\n                qualifications1: \"Google Ads Master - 2020\",\n                qualifications2: \"Google Ads Master - 2021\",\n                qualifications3: {\n                  text: \"2019 Kickstart Coding Challenge - Bronze\",\n                  start: \"2019 Jan\",\n                  end: \"2019 Nov\",\n                }\n            }\n          };\n        const dbObj = data;//await loadWebsiteContent() || {};\n        console.log(\"Loaded dbObj: \", dbObj);\n        var sections = parentElement.id.split(/-|~/g);\n        // sections.unshift(\"obj\");\n        console.log(\"el.id: \", parentElement.id);\n        console.log(\"sections: \", sections);\n        var val = extractElementContent(parentElement);\n        // Modifies dbObj by reference.\n        /*var newObj = */createNestedObj(dbObj, sections, val);\n        // console.log(JSON.stringify(newObj));\n        console.log(\"Returned: \", dbObj);\n        await saveWebsiteContent(dbObj);\n    }\n\n    // Creates a nested Object, retains existing values.\n    // const createNestedObj = (obj, keys, val) => { \n    //     const lastKey = keys.pop();\n    //     const lastObj = keys.reduce((obj, key) => \n    //         obj[key] = obj[key] || {}, \n    //         obj\n    //     ); \n    //     console.log('lastObj: ', lastObj);\n    //     console.log('lastKey: ', lastKey);\n    //     lastObj[lastKey] = val;\n    //     return lastObj;\n    // };\n\n    // const createNestedObj = ( base, names, values ) => {\n    //     for( var i in names ) base = base[ names[i] ] = base[ names[i] ] || (values[i] || {});\n    // };\n\n    /*const createNestedObj = (obj, keyPath, value) => {\n        var lastKeyIndex = keyPath.length-1;\n        for (var i = 0; i < lastKeyIndex; ++ i) {\n            var key = keyPath[i];\n            console.log(\"Handling key: \", key);\n            if (!(key in obj)){\n                obj[key] = {}\n            }\n            obj = obj[key];\n        }\n        obj[keyPath[lastKeyIndex]] = value;\n        console.log(\"RETURNING: \", obj);\n        return obj;\n    }*/\n    /*\n    var createNestedObj = function( base, names, value ) {\n        // If a value is given, remove the last name and keep it for later:\n        var lastName = arguments.length === 3 ? names.pop() : false;\n    \n        // Walk the hierarchy, creating new objects where needed.\n        // If the lastName was removed, then the last object is not set yet:\n        for( var i = 0; i < names.length; i++ ) {\n            base = base[ names[i] ] = base[ names[i] ] || {};\n        }\n    \n        // If a value was given, set it to the last name:\n        if( lastName ) base = base[ lastName ] = value;\n        \n        // Return the last object in the hierarchy:\n        return base;\n    };\n    */\n    const createNestedObj = (obj, path, value) => {\n        if (path.length === 1) {\n            obj[path] = value\n            return;\n        }\n        return createNestedObj(obj[path[0]], path.slice(1), value);\n    }\n    \n\n    const loadWebsiteContent = async () => {\n        // console.log('projectName: ', currentUid, projectName);\n        return db.collection('CMS_WebsiteContent')\n            .doc(projectName)\n            .get()\n            .then(doc => {\n                return doc.data();\n            })\n            .catch(err => console.error(\"Error loading website content: \", err))\n    };\n\n    const saveWebsiteContent = async (obj) => {\n        // console.log('projectName: ', currentUid, projectName);\n        return db.collection('CMS_WebsiteContent')\n            .doc(projectName)\n            .set(obj)\n            .then(() => {\n                return \"Success\";\n            })\n            .catch(err => console.error(\"Error saving website content: \", err))\n    };\n\n    const extractElementContent = (el) => {\n        console.log('Extracting text from: ', el, el.textContent);\n        return el.textContent.replace(/EditSaveCancel/,'');\n    }\n\n    const editClicked = (e) => {\n        createEditInput(e);\n    }\n\n    const toolbarOptions = [\n        ['bold', 'italic', 'underline', 'strike'],        // toggled buttons\n        ['blockquote', 'code-block'],\n      \n        [{ 'header': 1 }, { 'header': 2 }],               // custom button values\n        [{ 'list': 'ordered'}, { 'list': 'bullet' }],\n        [{ 'script': 'sub'}, { 'script': 'super' }],      // superscript/subscript\n        // [{ 'indent': '-1'}, { 'indent': '+1' }],          // outdent/indent\n        // [{ 'direction': 'rtl' }],                         // text direction\n      \n        [{ 'size': ['small', false, 'large', 'huge'] }],  // custom dropdown\n        [{ 'header': [1, 2, 3, 4, 5, 6, false] }],\n      \n        [{ 'color': [] }, { 'background': [] }],          // dropdown with defaults from theme\n        [{ 'font': [] }],\n        [{ 'align': [] }],\n      \n        ['clean']                                         // remove formatting button\n    ];\n\n    const createEditInput = (e) => {\n        console.log('Creating edit input');\n        var el = e.target;\n        var parentElement = el.closest('.cp-editable');\n        parentElement.classList.toggle('editing');\n        console.log('parentElement: ', parentElement);\n        var m = parentElement.innerHTML.match(/^[^<]*/);\n        var currentText = m[0].trim();\n        var regexp = new RegExp(m[0]);\n        \n        // var inp = document.createElement(\"input\");\n        if(!parentElement.querySelector('.ql-toolbar')){\n            \n            var quill = new Quill(parentElement.querySelector('.editor'), { //getCssSelector(parentElement)\n                modules: { toolbar: toolbarOptions },\n                theme: 'snow'\n            });\n            // var currentText = parentElement.innerHTML;//.replace(/EditSaveCancel$/,'');\n            // console.log('currentText: ', currentText);\n             // Match until the first <, which denotes HTML postfixes.\n            // console.log(\"m[0]: \", m[0]);\n            // currentText = m[0].trim();\n            // console.log('inner html: ', parentElement.innerHTML);\n            // console.log(\"replaced: \", parentElement.innerHTML.replace(regexp, ''));\n            \n            quill.setText(currentText);\n            parentElement.innerHTML = parentElement.innerHTML.replace(regexp, '');\n\n            quills[getCssSelector(parentElement)] = quill;\n        } else {\n            // Editor already exists, just show it\n            parentElement.querySelector('.ql-toolbar').style.display = \"block\";\n            parentElement.querySelector('.ql-container').style.display = \"block\";\n            // var currentText = parentElement.textContent;\n            // currentText = currentText.replace(/EditSaveCancel$/,'');\n            // currentText = m[0].trim();\n            // var replaceText = new RegExp(currentText + \"EditSaveCancel\");\n            parentElement.innerHTML = parentElement.innerHTML.replace(regexp, '');\n            // quills[getCssSelector(parentElement)].setText(currentText);\n        }\n\n        // Redefine click events for buttons.\n        parentElement.querySelector('.cp-editable-cancel-btn').onclick = (e) => {\n            cancelClicked(e);\n        }\n        parentElement.querySelector('.cp-editable-save-btn').onclick = (e) => {\n            saveClicked(e);\n        }\n    }\n\n\n\n    const highlightEditable = () => {\n        console.log('Highlighting everything!!!');\n        addEditButton();\n\n        // Attach CSS to head\n        const root = getIframe();\n        console.log(\"root: \", root);\n        root.head.insertAdjacentHTML('beforeend', `\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;\n                }\n                .cp-editable::after {\n                    content: \"\";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    bottom: -5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn {\n                    display: block;\n                }\n            </style>\n        `)\n    }\n\n    return <React.Fragment />;\n}\n\n// for(var i=0;i<sections.length;i++){\n        //     console.log('handling section: ', sections[i]);\n        //     var numberMatch = sections[i].match(/([0-9]+)/);\n        //     var stringMatch = sections[i].match(/([a-zA-Z0-9]+)/);\n            \n        //     if(stringMatch){\n        //         console.log(\"stringMatch: \", stringMatch);\n        //         path.push({\n        //             action: \"Dictionary\",\n        //             value: stringMatch[0]\n        //         });\n        //         // out[stringMatch[0]] = undefined;// extractElementContent(el);\n        //     }\n        //     else if(numberMatch){\n        //         // Create array index.\n        //         // Add previous index if it exists.\n        //         path.push({\n        //             action: \"Array\",\n        //             value: numberMatch[0]\n        //         })\n        //         // out[numberMatch[0]] = undefined;//extractElementContent(el);\n        //     }\n        // }\n        // return path;\n        // for(var i=sections.length-1;0;i--){\n        //     console.log('handling section: ', sections[i]);\n        //     var numberMatch = sections[i].match(/([0-9]+)/);\n        //     var stringMatch = sections[i].match(/([a-zA-Z0-9]+)/);\n        //     if(numberMatch){\n        //         // Create array index.\n        //         out[numberMatch[0]] = extractElementContent(el);\n        //     }\n        //     else if(stringMatch){\n        //         console.log(\"stringMatch: \", stringMatch);\n        //         out[stringMatch[0]] = extractElementContent(el);\n        //     }\n        // }","// Client-facing CMS\n// Client navigates to their webpage, then to /edit, then they can update the content as they wish.\n\nimport React, {useState, useEffect, useCallback} from 'react';\nimport {Helmet} from \"react-helmet\";\n// import firebase from 'firebase/app';\nimport firebase from \"firebase\";\n// import 'firebase/firestore';\n// import 'firebase/auth';\n// import 'firebase/storage';\n\n// import 'firebase/auth';\n// import 'firebase/storage';\nimport { Check, Square, Plus, X, Edit, Trash2, Image, Headphones, File, Paperclip } from 'react-feather';\nimport profile from './assets/profile.png';\n// import blank_image from '../assets/blank_image.png';\n// import blank_audio from '../assets/blank_audio.png';\nimport Loading from './loading.js';\nimport TextEditor from './textEditor.js';\nimport RichTextEditor from 'react-rte';\nimport { LazyLoadImage } from 'react-lazy-load-image-component';\nimport DatePicker from \"react-datepicker\"\nimport \"react-datepicker/dist/react-datepicker.css\";\nimport {firebaseDate2DisplayDate} from './commonFunctions';\nimport {\n    STORAGE_ROOT\n} from './constants';\nimport WebpageEditor from './webpageEditor.js';\n// import 'react-pdf/dist/esm/Page/AnnotationLayer.css';\n// import { Document, Page } from 'react-pdf';\n// import { pdfjs } from 'react-pdf';\n// pdfjs.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.js`;\nimport UpdatePage from './UpdatePage.js';\n\nimport firebaseConfig from './config';\n/* \n    Your Firebase config file via \n    1. Firebase console\n    2. Click on Project Settings to get this\n    3. Save to an external folder and import here.\n*/\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\n\nexport default function CMS({\n    projectName,\n    children,\n}){\n    const [loginComplete, setLoginComplete] = useState(false);\n    const [currentUid, setCurrentUid] = useState();\n    const [currentUser, setCurrentUser] = useState({});\n    const [currentEmail, setCurrentEmail] = useState(\"\");\n    const [currentSection, setCurrentSection] = useState(\"\");\n    const [pageData, setPageData] = useState({sections:[]});\n    const [selectedSectionIndex, setSelectedSectionIndex] = useState(0);\n    const [showingNew, setShowingNew] = useState(false);\n    const [newText, setNewText] = useState(\"\");\n    const [newTitle, setNewTitle] = useState(\"\");\n    const [newDate, setNewDate] = useState(new Date()); //useState(undefined);\n    const [showSaving, setShowSaving] = useState(false);\n    const [showingEdit, setShowingEdit] = useState(undefined);\n    const [showingDeleteDialog, setShowingDeleteDialog] = useState(false);\n    const [frameLoaded, setFrameLoaded] = useState(false);\n    const [webpageEditable, setWebpageEditable] = useState(false);\n\n    const [newImages, setNewImages] = useState([]);\n    const [newFiles, setNewFiles] = useState([]);\n    const [newAudio, setNewAudio] = useState([]);\n\n    const [rteInitTitle, setRteInitTitle] = useState();\n    const [rteInitContent, setRteInitContent] = useState();\n\n    const [showingAdditionalDate, setShowingAdditionalDate] = useState(false);\n    const [additionalDate, setAdditionalDate] = useState(new Date());\n\n    const [editType, setEditType] = useState(0);\n\n    const [storage, setStorage] = useState();\n\n    useEffect(()=>{\n        if(!currentUid){           \n            setStorage(firebase.storage().ref());\n\n            var provider = new firebase.auth.GoogleAuthProvider();\n            provider.addScope('https://www.googleapis.com/auth/contacts.readonly');\n            firebase.auth().onAuthStateChanged(function(user) {\n                if (user) {\n                    // User is signed in.\n                    // var displayName = user.displayName;\n                    // var email = user.email;\n                    // var emailVerified = user.emailVerified;\n                    // var photoURL = user.photoURL;\n                    // var isAnonymous = user.isAnonymous;\n                    // var uid = user.uid;\n                    // var providerData = user.providerData;\n                    // console.log('Login complete: ', user.uid);\n                    setCurrentEmail(user.email);\n                    setCurrentUser(user);\n                    // console.log(user);\n                    // console.log(user);\n                    setLoginComplete(true);\n                    setCurrentUid(user.uid);\n                } else {\n                    // console.log('Not signed in');\n                    setLoginComplete(true);\n                    setCurrentUid(\"\");\n                    setCurrentUser(\"\");\n                    setCurrentEmail(\"\");\n                }   \n            })\n\n            firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)\n            // .then(()=>{\n            //     firebase.auth().signInWithEmailAndPassword(email, password).catch(function(error) {\n            //         var errorCode = error.code;\n            //         var errorMessage = error.message;\n            //     });\n            // })\n        }\n    }, []);\n\n    // useEffect(()=>{\n    //     setNewTitle(\"\");\n    //     setNewText(\"\");\n    // }, showingNew);\n\n    const LogIn = () => {\n        var provider = new firebase.auth.GoogleAuthProvider();\n        // provider.addScope('https://www.googleapis.com/auth/contacts.readonly');\n        firebase.auth().signInWithPopup(provider).then(function(result) {\n            // This gives you a Google Access Token. You can use it to access the Google API.\n            // var token = result.credential.accessToken;\n            // var user = result.user;\n            // setCurrentUid(user.uid);\n            // setCurrentUser(user);\n            // setCurrentEmail(user.email);\n            // setLoginComplete(true);\n          }).catch(function(err) {\n            // Handle Errors here.\n            // var errorCode = error.code;\n            // var errorMessage = error.message;\n            // // The email of the user's account used.\n            // var email = error.email;\n            // // The firebase.auth.AuthCredential type that was used.\n            // var credential = error.credential;\n            console.error(\"Error signing in: \", err);\n          });\n    }\n\n    useEffect(()=>{\n        // DB calls to load data to edit\n        // console.log('Initializing CMS data');\n        if(currentUid){\n            authTest();\n            init();\n        }\n    }, [loginComplete, currentUid])\n\n    // Try and set some dummy data to check if it's possible\n    const authTest = () => {\n        if(!db) return;\n        db.collection('CMS') \n            .doc(projectName)\n            .set({\n                lastLogin: firebase.firestore.FieldValue.serverTimestamp()\n            }, {merge: true})\n            .then((e) => {\n                console.log(e);\n            }).catch(err => {\n                console.error(\"Error in authTest: \", err);\n                firebase.auth().signOut();\n            });\n        \n    }\n\n    const init = () => {\n        // console.log(\"currentUid: \", currentUid);\n        loadWebpageDataFromUid().then(pageData => {\n            // console.log('init pageData!!!!: ', pageData);\n            if(!pageData && loginComplete){\n                firebase.auth().signOut();\n                return;\n            }\n            setPageData(pageData || {sections:[]})\n            setWebpageEditable(pageData.webpageEditable);\n            if(pageData.webpageEditable)\n                setEditType(0);\n            loadAllSectionData(pageData || {sections:[]}).then(d => {\n                // console.log(d)\n                // setPageData({\n                //     ...pageData, \n                //     ...d\n                // })\n            })\n            // Default to first section\n            if(pageData && pageData.sections.length) \n                setCurrentSection(pageData.sections[0] || \"\");\n        });\n    }\n\n    const loadWebpageDataFromUid = async () => {\n        // console.log('projectName: ', currentUid, projectName);\n        if(!db || !currentUid || !loginComplete) return {sections:[]};\n        return db.collection('CMS')\n            .doc(projectName)\n            .get()\n            .then(doc => {\n\n                // console.log(doc.data());\n                // const serverUid = doc.get('uid');\n                const serverEmail = doc.get('email');\n                // if(    currentEmail === serverEmail  \n                //     || currentEmail === 'jun.a.kagaya@gmail.com' \n                //     || currentEmail === 'powerofrepetition@gmail.com'){\n                // if(serverUid === currentUid){\n                    // console.log(\"user confirmed: \", serverEmail);\n                    // return db.collection('CMS')\n                    //     .doc(projectName)\n                    //     .get()\n                    //     .then(doc => {\n                    //         // console.log(doc.data())\n                    //         return doc.data() || [];\n                    //     })\n                    return doc.data() || {sections:[]};\n                // }\n                // else {\n                //     console.error(\"user mismatch: \", serverEmail, \" <=> \",currentEmail);\n                //     return {sections:[]};\n                // }\n            })\n            .catch(err => {\n                console.error(\"Error reading user data: \", err);\n                return undefined;\n            })\n    }\n\n    // useEffect(()=>{\n        // loadAllSectionData();\n        // console.dir(pageData)\n    // }, [pageData]);\n\n    const forceUpdate = useCallback(()=>{\n        updatePageData({});\n    }, []);\n\n    const [, updatePageData] = useState();\n\n    const loadAllSectionData = async (data) => {\n        // console.log(data)\n        if(!data.sections) return;\n        const promises = [];\n        const out = {};\n        data.sections.forEach((section) => {\n            promises.push(\n                loadSectionData(section, data).then(d => {\n                    out[section] = d;\n                })\n            );\n            // setPageData({\n            //     ...data, \n            //     [section]: d\n            // })\n        })\n        \n        return Promise.all(promises).then(()=>{\n            // console.log(out)\n            return out;\n        });\n    }\n\n    const loadSectionData = async (sectionName, data) => {\n        // console.log('Loading data for: ', sectionName);\n        return db.collection('CMS')\n            .doc(projectName)\n            .collection(sectionName)\n            // .orderBy('createdOn', 'desc')\n            .orderBy('date', 'desc')\n            .onSnapshot((snapshot) => {\n                snapshot.docChanges().forEach((change) => {\n                    const p = data;\n                    if(!p[sectionName]) p[sectionName] = {};\n                    if(change.type === 'added' || change.type === 'modified'){\n                        // Backcompatibility converting old imageURL/audioURL into array of objects\n                        const out = change.doc.data();\n                        if(out.imageURL){\n                            out.images = [\n                                {\n                                    id: Date.now().toString(),\n                                    url: out.imageURL,\n                                    path: \"\",\n                                    name: \"\",\n                                }\n                            ]\n                        }\n                        if(out.audioURL){\n                            out.audio = [\n                                {\n                                    id: Date.now().toString(),\n                                    url: out.audioURL,\n                                    name: \"\",\n                                    path: \"\",\n                                }\n                            ]\n                        }\n                        p[sectionName][change.doc.id] = {...out, id: change.doc.id};\n                        \n                        // console.log('added new: ', p.sections, p);\n                    }\n                    else if(change.type === 'removed'){\n                        delete p[sectionName][change.doc.id];\n                    }\n                    \n                    setPageData(p);\n                    forceUpdate();\n                })\n            })\n    }\n\n    const saveImage = async (fileObj) => {\n        if(!fileObj.localFile) {\n            return {\n                url: fileObj.url, \n                path: fileObj.path\n            }\n        }\n        const metaData = {\n            customMetadata: {\n                \"uploader\": currentEmail\n            }\n        }\n        const path = getStoragePath('images', fileObj.name);\n        var storageRef = storage.child(path);\n        return storageRef.put(fileObj.localFile, metaData).then(snapshot => {\n            console.log(\"Uploaded Image\");\n            return snapshot.ref.getDownloadURL().then(url => {\n                return {url, path};\n            })\n        })\n    }\n\n    const saveAudio = async (fileObj) => {\n        if(!fileObj.localFile) {\n            return {\n                url: fileObj.url, \n                path: fileObj.path\n            }\n        }\n        const metaData = {\n            customMetadata: {\n                \"uploader\": currentEmail\n            }\n        }\n        const path = getStoragePath('audio', fileObj.name);\n        var storageRef = storage.child(path);\n        return storageRef.put(fileObj.localFile, metaData).then((snapshot) => {\n            console.log('Uploaded Audio');\n            return snapshot.ref.getDownloadURL().then(url => {\n                return {url, path};\n            })\n        })\n        .catch(err => {\n            console.error(\"Error saving audio: \", err);\n        })\n    }\n\n    const saveMiscellaneous = async (fileObj) => {\n        // If local file exists, it means it has been freshly uploaded and needs to be saved, \n        // Otherwise it has already been saved and can be ignored\n        if(!fileObj.localFile) {\n            return {\n                url: fileObj.url, \n                path: fileObj.path\n            };\n        }\n\n        const metaData = {\n            customMetadata: {\n                \"uploader\": currentEmail\n            }\n        }\n\n        const path = getStoragePath('miscellaneous', fileObj.name);\n        console.log('saving fileObj: ', fileObj);\n        var storageRef = storage.child(path);\n        return storageRef.put(fileObj.localFile, metaData).then((snapshot) => {\n            console.log('Uploaded miscellaneous');\n            return snapshot.ref.getDownloadURL().then(url => {\n                return {url, path};\n            })\n        })\n        .catch(err => {\n            console.error(\"Error saving miscellaneous: \", err);\n        })\n    }\n\n    const getStoragePath = (type, filename) => {\n        // return currentEmail + \"/\" + type + \"/\" + Date.now() + \"-\" + filename;\n        // Remove the date from here, looks ugly.\n        //return currentEmail + \"/\" + type + \"/\" + filename;\n        return projectName + \"/\" + type + \"/\" + filename;\n    }\n\n    // Saves new article, or news item, etc.\n    const saveNew = async () => {\n        // Hack to trigger state change and rfresh TextEditor\n        setShowSaving(true);\n        setRteInitTitle(\"_\");\n        setRteInitContent(\"_\");\n        let sectionName = pageData.sections[selectedSectionIndex];\n        \n        // Only save to storage if not already saved, determined by checking to see if it is local link.\n        var imgObjs = [];\n        for(var i=0;i<newImages.length;i++){\n            var imgObj = (newImages[i].downloadUrl || \"\").includes(STORAGE_ROOT)\n                ? newImages[i] : await saveImage(newImages[i]);\n            imgObjs.push({\n                ...imgObj,\n                id: newImages[i].id,\n                name: newImages[i].name\n            });\n        }\n\n        var audioObjs = [];\n        for(var i=0;i<newAudio.length;i++){\n            var audioObj = (newAudio[i].downloadUrl || \"\").includes(STORAGE_ROOT)\n                ? newAudio[i] : await saveAudio(newAudio[i]);\n                audioObjs.push({\n                    ...audioObj,\n                    id: newAudio[i].id,\n                    name: newAudio[i].name\n                });\n        }\n\n        \n        // var imageObj = (newImage.url || \"\").includes(STORAGE_ROOT) \n        //     ? newImage : await saveImage();\n        // var audioObj = (newAudio || \"\").includes(STORAGE_ROOT) \n        //     ? newAudio : await saveAudio();\n\n        var fileObjs = [];\n        for(var i=0;i<newFiles.length;i++){\n            var fileObj = (newFiles[i].downloadUrl || \"\").includes(STORAGE_ROOT)\n                ? newFiles[i] : await saveMiscellaneous(newFiles[i]);\n            fileObjs.push({\n                ...fileObj,\n                // downloadUrl: newFiles[i].downloadUrl,\n                id: newFiles[i].id,\n                name: newFiles[i].name,\n            });\n        }\n        // console.log(\"imageObj: \", imageObj);\n        const d = {};\n\n        // if(imageObj) {\n        //     d[\"imageObj\"] = imageObj.url || \"\";\n        //     d['imageObj'] = imageObj.path || \"\";\n        // }\n        // if(audioObj) {\n        //     d[\"audioURL\"] = audioObj.url || \"\";\n        //     d[\"audioPath\"] = audioObj.path || \"\";\n        // }\n        d['images'] = imgObjs || [];\n        d['audio'] = audioObjs || [];\n        d['files'] = fileObjs || [];\n\n        if(newTitle) d[\"title\"] = newTitle;\n        if(newText) d['content'] = newText;\n        if(newDate) {\n            d['date'] = newDate;\n        } else {\n            d['date'] = new Date().toLocaleDateString('en-CA').toString();\n        }\n        if(showingAdditionalDate && additionalDate){\n            d['additionalDate'] = additionalDate;\n        } else {\n            d['additionalDate'] = \"\";\n        }\n        d['createdOn'] = firebase.firestore.FieldValue.serverTimestamp();\n\n        var id = showingEdit \n            ? showingEdit.id \n            : Date.now().toString();\n        \n            // console.log('SAVING: ', d);\n\n        db.collection('CMS')\n            .doc(projectName)\n            .collection(sectionName)\n            .doc(id)\n            .set(d, {merge: true})\n            .then(()=>{\n                console.log('Successfully saved entry');\n                setShowSaving(false);\n                setShowingNew(false);\n                setShowingEdit(undefined);\n                setRteInitTitle(\"\");\n                setRteInitContent(\"\");\n                setNewTitle(\"\");\n                setNewText(\"\");\n                setNewDate(new Date());\n                setAdditionalDate(new Date());\n                setNewAudio([]);\n                setNewImages([]);\n                setNewFiles([]);\n                setShowingAdditionalDate(false);\n                // console.log('reset all fields');\n            })\n            .catch(err => {\n                console.error(\"Error saving new entry: \", err);\n                setShowSaving(false);\n                setShowingNew(false);\n            })\n    }\n\n    // useEffect(()=>{\n    //     console.log('new title: ', newTitle);\n    // }, [newTitle])\n\n    // useEffect(()=>{\n    //     console.log('rteInitTitle: ', rteInitTitle);\n    // }, [rteInitTitle])\n\n    const updateSelectedSectionIndex = (i) => {\n        setCurrentSection(pageData.sections[i]);\n        setSelectedSectionIndex(i);\n    }\n\n    const onTextChange = (e) => {\n        var text = e;//e.target.value;\n        setNewText(text);\n    }\n\n    const onTitleChange = (e) => {\n        // console.log(e);\n        // It's directly HTML now\n        setNewTitle(e);\n        // setNewTitle(e.target.value);\n    }\n\n    const onAudioAdded = (e) => {\n        // var audio = e.target.files[0];\n        // // setNewAudio(URL.createObjectURL(audio));\n        // if(audio && e.target.files.length){\n        //     setNewAudio(URL.createObjectURL(audio));\n        //     setNewAudioFile(audio);\n        // }\n        var file = e.target.files[0];\n        console.log(\"audio added: \", file);\n        if(file && e.target.files.length){\n            setNewAudio(\n                [...(newAudio || []),\n                {\n                    id: Date.now().toString(),\n                    url: URL.createObjectURL(file),\n                    name: file.name,\n                    localFile: file,\n                }\n                ]\n            );\n        }\n    }\n\n    const onImageAdded = (e) => {\n        var file = e.target.files[0];\n        console.log(\"image added: \", file);\n        if(file && e.target.files.length){\n            setNewImages(\n                [...(newImages || []),\n                {\n                    id: Date.now().toString(),\n                    url: URL.createObjectURL(file),\n                    name: file.name,\n                    localFile: file,\n                }\n                ]\n            );\n        }\n    }\n    // useEffect(()=>{\n    //     console.log(newImages);\n    // }, [newImages])\n\n    const onFileAdded = (e) => {\n        var file = e.target.files[0];\n        console.log(\"file added: \", file);\n        if(file && e.target.files.length){\n            setNewFiles(\n                [...(newFiles || []),\n                {\n                    id: Date.now().toString(),// For deletion\n                    downloadUrl: URL.createObjectURL(file),\n                    name: file.name,\n                    localFile: file,\n                }\n                ]\n            );\n        }\n    }\n\n    // useEffect(()=>{\n    //     console.log(\"newFiles: \", newFiles);\n    // }, [newFiles]);\n\n    const onDateAdded = (e) => {\n        // console.log(e);\n        setNewDate(e);\n        // setNewDate(e.target.value);\n    }\n\n    const onAdditionalDateAdded = (e) => {\n        setAdditionalDate(e);\n    }\n\n    const hideShowingNew = () => {\n        setShowingEdit(undefined);\n        setShowingNew(!showingNew);\n        setNewAudio([]);\n        setNewImages([]);\n        setNewDate(new Date());\n        setNewFiles([]);\n        setAdditionalDate(new Date());\n        setNewTitle(\"\");\n        setShowingAdditionalDate(false);\n        setNewText(\"\");\n        setRteInitTitle(\"\");\n        setRteInitContent(\"\");\n    }\n\n    const removeUploadedImg = (url) => {\n        deleteStoredObject('image', url);\n        setNewImages(newImages.filter(f => f.url !== url));\n    }\n\n    const removeUploadedAudio = (url) => {\n        deleteStoredObject('audio', url);\n        setNewAudio(newAudio.filter(f => f.url !== url));\n    }\n\n    const removeUploadedMiscellaneous = (url) => {\n        console.log('removing fileId: ', url);\n        console.log(\"newFiles: \", newFiles);\n        deleteStoredObject('miscellaneous', url);\n        setNewFiles(newFiles.filter(f => f.url !== url));\n    }\n\n    const deleteSectionContent = (entry, projectName, sectionName) => {\n        // console.log('deleting all of entry: ', entry)\n\n        if(newImages.length) {\n            for(var newFile of newImages){\n                // console.log('deleting: ', newFile);\n                deleteStoredObject('image', newFile.downloadUrl);\n            }\n        }\n\n        if(newAudio.length) {\n            for(var newFile of newAudio){\n                // console.log('deleting: ', newFile);\n                deleteStoredObject('audio', newFile.downloadUrl);\n            }\n        }\n        \n        if(newFiles.length) {\n            for(var newFile of newFiles){\n                // console.log('deleting: ', newFile);\n                deleteStoredObject('miscellaneous', newFile.downloadUrl);\n            }\n        }\n        if(entry.images && entry.images.length) {\n            for(var newFile of entry.images){\n                // console.log('deleting: ', newFile);\n                deleteStoredObject('image', newFile.url);\n            }\n        }\n\n        if(entry.audio && entry.audio.length) {\n            for(var newFile of entry.audio){\n                // console.log('deleting: ', newFile);\n                deleteStoredObject('audio', newFile.url);\n            }\n        }\n        \n        if(entry.files && entry.files.length) {\n            for(var newFile of entry.files){\n                // console.log('deleting: ', newFile);\n                deleteStoredObject('miscellaneous', newFile.url);\n            }\n        }\n\n        db.collection('CMS')\n            .doc(projectName)    \n            .collection(sectionName)\n            .doc(entry.id)\n            .delete()\n            .then(()=>{\n                // console.log('Successfully deleted entry');\n            })\n            .catch(err => {\n                console.error(\"Error deleting entry: \", err);\n            });\n    }\n    \n    const deleteStoredObject = (type, downloadUrl) => {\n        // Only delete if the url is to an existing file\n        // console.log(\"deleting url 1: \", downloadUrl);\n        /*switch(type){\n            case 'image': {\n                if(!(newImage.url || \"\").includes(STORAGE_ROOT)){\n                    return;\n                }\n                break;\n            }\n            case 'audio': {\n                if(!(newAudio.url || \"\").includes(STORAGE_ROOT)){\n                    return;\n                }\n                break;\n            }\n            case 'miscellaneous': {\n                if(!(downloadUrl || \"\").includes(STORAGE_ROOT)){\n                    return;\n                }\n                break;\n            }\n            default: {\n                console.error('Returning on default');\n                return;\n            }\n        }*/\n        if(!(downloadUrl || \"\").includes(STORAGE_ROOT)){\n            return;\n        }\n    \n        firebase.storage().refFromURL(downloadUrl).delete().then(()=>{\n            // console.log('Deleted successfully: ', downloadUrl);\n        }).catch(err => {\n            console.error(\"Error deleting stored item\");\n        }) \n    }\n\n    const toggleAdditionalDate = () => {\n        setShowingAdditionalDate(!showingAdditionalDate);\n    }\n\n    // console.log(\"additionalDate: \", additionalDate);\n    // console.log('loginComplete: ', loginComplete, currentUid, !currentUid && loginComplete);\n    return(\n        <div className=\"CMS\">\n            <Helmet>\n                <meta charSet=\"utf-8\" />\n                <title>Update your website</title>\n                <link rel=\"icon\" type=\"image/png\" href=\"blank.ico\" sizes=\"16x16\" />\n            </Helmet>\n            {\n                !currentUid && loginComplete &&\n                <div className=\"overlay\">\n                    <div className=\"content\">\n                        <h2>Login to update your website</h2>\n                        <p>Please use your approved email address</p>\n                        {/* <p>Update your website content</p> */}\n                        <div className=\"login\" onClick={()=>{LogIn()}}>\n                            <span>Login</span>\n                        </div>\n                    </div>\n                </div>\n            }\n            <div className=\"inner\">\n                <div className=\"left\">\n                    <div className=\"title\">\n                        <h4 className=\"subtitle\">Website Content Management</h4>\n                        <h1>{pageData.projectName}</h1>\n                    </div>\n                    { webpageEditable\n                        ? <div className={\"editType-wrapper \" + (editType === 0 ? \"left-selected\" : \"right-selected\")}>\n                            <div className={editType === 0 ? \"selected\" : \"\"} onClick={()=>setEditType(0)}>Page Content</div>\n                            <div className={editType === 1 ? \"selected\" : \"\"} onClick={()=>setEditType(1)}>Dynamic Content</div>\n                        </div>\n                        : \"\"\n                    }\n                    { editType === 0\n                        ? <div className=\"sections-wrapper\">\n                            <div className=\"section\" style={{backgroundColor:\"white\"}}>Select text on the right to edit it.</div>\n                        </div>\n                        : <div className=\"sections-wrapper\">\n                            { pageData.sections &&\n                                pageData.sections.map((section, i) => (\n                                    <div key={\"left-section-\"+i} className={\"section \" + (selectedSectionIndex === i ? \"selected\" : \"\")} onClick={()=>{updateSelectedSectionIndex(i)}}>{section}</div>\n                                ))\n                            }\n                        </div>\n                    }\n                    <div className=\"profile\">\n                        { currentUser.photoURL\n                            ? <LazyLoadImage src={currentUser.photoURL} effect=\"blur\" alt=\"\" />\n                            : <LazyLoadImage src={profile} effect=\"blur\" alt=\"\" />\n                        }\n                        <div className=\"details-wrapper\">\n                            {\n                                currentUser.displayName\n                                ? <div className=\"displayName\"><span>{currentUser.displayName}</span></div>\n                                : <div onClick={()=>{LogIn()}}></div>\n                            }\n                            {\n                                currentUser.email\n                                ? <div className=\"email\"><span>{currentUser.email}</span></div>\n                                : <div></div>\n                            }\n                        </div>\n                        { currentUser\n                            ? <X onClick={()=>{firebase.auth().signOut();}}/>\n                            : \"\"\n                        }\n                    </div>\n                    <div className=\"attribution\">\n                        <span>Website content management - Webbi&copy; 2020</span>\n                    </div>\n                </div>\n                <div className=\"right\">\n                    { editType === 0\n                        ? <WebpageEditor /*pageData={pageData}*/ setFrameLoaded={setFrameLoaded} /*children={children}*/>\n                            {children}\n                            <UpdatePage projectName={projectName} db={db} frameLoaded={frameLoaded} />\n                        </WebpageEditor>\n                        : <React.Fragment>\n                            <div className=\"top\">\n                                <div className=\"header\">\n                                    { \n                                        pageData.sections && <h1>{pageData.sections[selectedSectionIndex]}</h1>\n                                    }\n                                </div>\n                                <div className=\"wrapper\" onClick={()=>{setShowingNew(!showingNew)}}>\n                                    {\n                                        showingNew \n                                        ? <X width=\"48\" />\n                                        : <Plus width=\"48\" />\n                                    }\n                                </div>\n                            </div>\n                            <div className=\"inner\">\n                                { pageData.sections && \n                                    (Object.values(pageData[currentSection] || {})).map((entry, index) => (\n                                        <SectionContent \n                                            key={\"inner-entry-\" + index} \n                                            entry={entry} \n                                            setShowingEdit={setShowingEdit}\n                                            setShowingNew={setShowingNew}\n                                            setNewAudio={setNewAudio}\n                                            setNewImages={setNewImages}\n                                            setNewFiles={setNewFiles}\n                                            setNewDate={setNewDate}\n                                            setAdditionalDate={setAdditionalDate}\n                                            setNewTitle={setNewTitle}\n                                            setNewText={setNewText}\n                                            setShowingDeleteDialog={setShowingDeleteDialog}\n                                            projectName={projectName}\n                                            sectionName={currentSection}\n                                            setRteInitTitle={setRteInitTitle}\n                                            setRteInitContent={setRteInitContent}\n                                            setShowingAdditionalDate={setShowingAdditionalDate}\n                                        />\n                                    ))\n                                }\n                            </div>\n                        </React.Fragment>\n                    }\n                </div>\n                <div className={\"overlay \" + (showingNew ? \"showing\" : \"\")} onClick={()=>{hideShowingNew()}}></div>\n                <div className={\"modal \" + (showingNew ? \"showing\" : \"\")}>\n                    <div className=\"title\">\n                        <div>\n                            <X onClick={()=>{\n                                hideShowingNew();\n                            }} />\n                            {pageData.sections ?\n                                showingEdit\n                                    ? <h1>Edit {currentSection.toString().toLowerCase()}</h1>\n                                    : <h1>Create {currentSection.toString().toLowerCase()}</h1>\n                                : \"\"\n                            }\n                            {/* {pageData.sections[selectedSectionIndex]} */}\n                        </div>\n                        <div>\n                            <div className=\"save ok\" onClick={()=>{saveNew()}}>\n                                <span>Save</span>\n                            </div>\n                        </div>\n                    </div>\n                    <div className=\"content\">\n                        <div className=\"media-upload-wrapper\">\n                                <React.Fragment>\n                                    <label htmlFor=\"image-upload\">\n                                        <div className=\"image-upload-wrapper\">\n                                            <Image />\n                                            {/* <img src={blank_image} alt=\"\" /> */}\n                                        </div>\n                                    </label>\n                                    <input id=\"image-upload\" type=\"file\" onChange={onImageAdded} hidden={true} accept=\"image/*\" onClick={(e)=>{e.target.value = \"\"}} />\n                                </React.Fragment>\n                            {/* } */}\n                            \n                            {/* <h4>Upload audio file</h4> */}\n                            {/* { !newAudio && */}\n                                <React.Fragment>\n                                    <label htmlFor=\"audio-upload\">\n                                        <div className=\"audio-upload-wrapper\">\n                                        {/* <img src={blank_audio} alt=\"\" /> */}\n                                            <Headphones />\n                                        </div>\n                                    </label>\n                                    <input id=\"audio-upload\" type=\"file\" onChange={onAudioAdded} hidden={true} accept=\".mp3,.aif,.aiff,.ogg,.wav,audio/*\" onClick={(e)=>{e.target.value = \"\"}} />\n                                </React.Fragment>\n                            {/* } */}\n                            \n                            {/* Generic file */}\n                            <label htmlFor=\"file-upload\">\n                                <div className=\"file-upload-wrapper\">\n                                    <File />\n                                </div>\n                            </label>\n                            {/* https://stackoverflow.com/questions/39484895/how-to-allow-input-type-file-to-select-the-same-file-in-react-component */}\n                            <input id=\"file-upload\" type=\"file\" onChange={onFileAdded} hidden={true} accept=\"application/pdf,application/msword,text/plain,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document\" onClick={(e)=>{e.target.value = \"\"}} />\n                        </div>\n\n                        <div className=\"uploaded-previews box\">\n                        { \n                            newImages && newImages.length\n                            ? <div>\n                                { newImages.map((newImage, i) => (\n                                    <div className=\"uploaded-img-wrapper\" key={\"img-\"+i}>\n                                        <LazyLoadImage className=\"uploaded-img\" src={newImage.url} effect=\"blur\" alt=\"\" />\n                                        <div onClick={()=>{removeUploadedImg(newImage.url)}}>\n                                            <X />\n                                        </div>\n                                    </div>\n                                    ))\n                                }\n                            </div>\n                            : \"\"\n                        }\n\n                        {\n                            newAudio && newAudio.length\n                            ? <div>\n                                { newAudio.map((audio, i) => (\n                                    <div className=\"uploaded-audio-wrapper\" key={\"audio-\"+i}>\n                                        <audio \n                                            controls \n                                            className=\"uploaded-audio\"\n                                            src={audio.url} type=\".mp3,audio/*\" \n                                        />\n                                        <div onClick={()=>{removeUploadedAudio(audio.url)}}>\n                                            <X />\n                                        </div>\n                                    </div>\n                                ))\n                                }\n                            </div>\n                            : \"\"\n                        }\n\n                        {\n                            newFiles && newFiles.length \n                            ? <div>\n                                { newFiles.map((newFile, i) => (\n                                    <div className=\"uploaded-miscellaneous-wrapper\" key={\"miscellaneous-\"+i}>\n                                        <div>\n                                            <a href={newFile.downloadUrl || newFile.url} download={newFile.name}>{newFile.name}</a>\n                                        </div>\n                                        <div onClick={()=>removeUploadedMiscellaneous(newFile.url)}>\n                                            <X />\n                                        </div>\n                                    </div>\n                                ))\n                                }\n                            </div>\n                            : \"\"\n                        }\n                        </div>\n\n                        {/* https://www.npmjs.com/package/react-date-picker */}\n                        <div className=\"box\">\n                            <div className=\"date-wrapper\">\n                                <h4>Date</h4>\n                                <div className=\"svg-wrapper\" onClick={()=>{toggleAdditionalDate()}}>\n                                    <label>Using a date range</label>\n                                    <div className={\"svg-wrapper-inner \" + (showingAdditionalDate ? \"showing\" : \"\")}>\n                                    {\n                                        showingAdditionalDate \n                                        // ? <Minus />\n                                        // : <Plus />\n                                        ? <Check />//<CheckSquare />\n                                        : <Square />\n                                    }\n                                    </div>\n                                </div>\n                                \n                            </div>\n                            {/* <input\n                                type=\"date\"\n                                // value={newDate}\n                                defaultValue={new Date().toLocaleDateString('en-CA').toString()}\n                                onChange={onDateAdded}\n                            /> */}\n                            <DatePicker\n                                onChange={onDateAdded}\n                                selected={newDate}\n                                // selected=\"2020-10-29\"\n                                dateFormat=\"yyyy-MM-dd\"\n                                // dateFormat=\"yyyy\"\n                                // defaultValue={new Date().toLocaleDateString('en-CA').toString()}\n                            />\n                            {\n                                showingAdditionalDate && \n                                <div id=\"additional-datepicker\">\n                                    <DatePicker\n                                        onChange={onAdditionalDateAdded}\n                                        selected={additionalDate}\n                                        dateFormat=\"yyyy-MM-dd\"//\"yyyy\"\n                                        // defaultValue={new Date().toLocaleDateString('en-CA').toString()}\n                                    />\n                                </div>\n                            }\n                        </div>\n\n                        <div className=\"title-upload box\">\n                            <h4>Title</h4>\n                            {/* <input value={newTitle} onChange={onTitleChange} /> */}\n                            <TextEditor \n                                // value={newTitle} \n                                // value={RichTextEditor.createValueFromString(newTitle, 'html')}\n                                initialValue={rteInitTitle}\n                                value={RichTextEditor.createValueFromString(newTitle, 'html')}\n                                onChange={onTitleChange} \n                            />\n                        </div>\n                        \n                        <div className=\"text-upload box\">\n                            <h4>Content</h4>\n                            {/* <textarea value={newText} onChange={onTextChange} /> */}\n                            <TextEditor \n                                // value={newText} \n                                // value={RichTextEditor.createValueFromString(newText, 'html')}\n                                initialValue={rteInitContent}\n                                value={RichTextEditor.createValueFromString(newText, 'html')}\n                                onChange={onTextChange} \n                                files={newFiles} // Pass files through to link to\n                            />\n                        </div>\n                    </div>\n                    \n                    <Loading loading={showSaving} /> \n                </div>\n\n                <div className={\"overlay \"+ (showingDeleteDialog ? \"showing\" : \"\")} onClick={()=>{setShowingDeleteDialog(false)}}></div>\n                <div className={\"deleteDialog \" + (showingDeleteDialog ? \"showing\" : \"\")}>\n                    <h4>Are you sure you want to delete this?</h4>\n                    <div className=\"options-wrapper\">\n                        <div className=\"cancel\" onClick={()=>{setShowingDeleteDialog(false);}}>\n                            <span>Cancel</span>\n                        </div>\n                        <div className=\"ok\" onClick={()=>{\n                            deleteSectionContent(showingDeleteDialog, projectName, currentSection);\n                            setShowingDeleteDialog(false);\n                        }}>\n                            <span>Ok</span>\n                        </div>\n                    </div>\n                </div>\n                \n            </div>\n            \n            {/* <div>\n                <label>Username</label>\n                <input value={username} onChange={setUsername} />\n                <label>Password</label>\n                <input valu={password} onChange={setPassword} />\n            </div> */}\n        </div>\n    )\n}\n\nconst SectionContent = ({\n    entry,\n    projectName,\n    sectionName,\n    setShowingEdit,\n    setShowingNew,\n    setNewAudio,\n    setNewImages,\n    setNewFiles,\n    setNewDate,\n    setAdditionalDate,\n    setNewTitle,\n    setNewText,\n    setShowingDeleteDialog,\n    setRteInitTitle,\n    setRteInitContent,\n    setShowingAdditionalDate,\n}) => {\n    // console.log(entry);\n    return(\n        <div className=\"SectionContent\">\n            <div className=\"content\">\n                <div className=\"cms-media-wrapper\">\n                    {\n                        // TODO Display images as small and in a grid\n                        (entry.images && entry.images.length)\n                        ? <LazyLoadImage src={entry.imageURL || entry.images[0].url} effect=\"blur\" width=\"260px\" \n                            // height=\"calc(100% - 54px)\" \n                            height=\"fit-content\"\n                            alt=\"\" />\n                        : \"\"\n                    }\n                    {\n                        (entry.audio && entry.audio.length)\n                        ? <audio controls src={entry.audioURL || entry.audio[0].url} type=\".mp3,audio/*\"/>\n                        : \"\"\n                    }\n                    {\n                        entry.files && entry.files.length ?\n                        <div className=\"file\">\n                            <Paperclip />\n                            <p>{entry.files.length} resource{entry.files.length > 1 ? \"s\" : \"\"}</p>\n                            {/* Could optionally add sizes here */}\n                        </div>\n                        : \"\"\n                    }\n                </div>\n                <div className=\"right-content\">\n                    {/* {entry.imgUrl && <img src={entry.imgUrl} />}\n                    {entry.audioURL && \n                        <audio controls>\n                            <source src={entry.audioURL} type=\"audio/mpeg\" />\n                        </audio>\n                    } */}\n                    <div dangerouslySetInnerHTML={{__html: entry.title}} />\n                    <div className=\"date-display-container\">\n                        {entry.date && <p className=\"date\">{firebaseDate2DisplayDate(entry.date)}</p>}\n                        {entry.additionalDate && <p className=\"additionalDate\">{firebaseDate2DisplayDate(entry.additionalDate)}</p>}\n                    </div>\n                    <div className=\"contents\" dangerouslySetInnerHTML={{__html:entry.content}} />\n                </div>\n            </div>\n            <div>\n                <div className=\"edit\" onClick={()=>{\n                    console.log('showing entry: ', entry);\n                    setShowingEdit(entry);\n                    setShowingNew(true);\n                    setNewAudio(entry.audio || []);\n                    setNewImages(entry.images || []);\n                    setNewFiles(entry.files || []);\n                    setNewDate(new Date(entry.date.seconds * 1000));\n                    if(entry.additionalDate){\n                        setShowingAdditionalDate(true);   \n                    }\n                    var ad = entry.additionalDate \n                        ? entry.additionalDate.seconds * 1000 \n                        : Date.now();\n                    // console.log(\"ad: \", ad);\n                    setAdditionalDate(new Date(ad));\n                    setNewTitle(entry.title || \"\");\n                    setNewText(entry.content || \"\");\n\n                    setRteInitTitle(entry.title || \"\");\n                    setRteInitContent(entry.content || \"\");\n                }}>\n                    <Edit />\n                </div>\n                <div className=\"delete\" onClick={()=>{\n                    setShowingDeleteDialog(entry);\n                }}>\n                    <Trash2 />\n                </div>\n            </div>\n        </div>\n    )\n}","export default {\n    apiKey: \"AIzaSyBiw4ORAbMmxImx4qPGq9JAFtUI36PeYQ0\",\n    authDomain: \"sheets2website-1598313088115.firebaseapp.com\",\n    databaseURL: \"https://sheets2website-1598313088115.firebaseio.com\",\n    projectId: \"sheets2website-1598313088115\",\n    storageBucket: \"sheets2website-1598313088115.appspot.com\",\n    messagingSenderId: \"1082271392691\",\n    appId: \"1:1082271392691:web:45c06be046a0a72b5b21c6\",\n    measurementId: \"G-ZWGE5NLZ4Z\"\n};","/* loaded by smart-asset */\nexport default \"profile~FlXvJqZg.png\"","import React from 'react'\nimport './index.css';\n\nimport CMS from 'react-firestore-cms'\nimport 'react-firestore-cms/dist/cms.css';\nimport 'react-firestore-cms/dist/loading.css';\nimport 'react-firestore-cms/dist/index.css';\nimport 'react-firestore-cms/dist/app.css';\n\nconst MyWebsite = () => {\n  const data = {\n    name: \"Jason\",\n    surname: \"Briggs\",\n    description: \"This is a paragraph that can be changed by pressing the edit button on the bottom right.\",\n    jobs: [\n      \"Software Engineer\",\n      \"Automation Tester\",\n      \"Developer Operations\",\n      \"Marketing & Sales Coordinator\",\n      \"Test Analyst\"\n    ],\n    careers: [\n      {\n        title: \"Automation Testing\",\n        duration: 2,\n      },\n      {\n        title: \"Junior Software Developer\",\n        duration: 5\n      },\n      {\n        title: \"Senior Software Developer\",\n        duration: 10,\n      }\n    ],\n    details: {\n      volunteer_work: \"Working at the Orphanage\",\n      qualifications1: \"Google Ads Master - 2020\",\n      qualifications2: \"Google Ads Master - 2021\",\n      qualifications3: {\n        text: \"2019 Kickstart Coding Challenge - Bronze\",\n        start: \"2019 Jan\",\n        end: \"2019 Nov\",\n      }\n\n    }\n  };\n\n  return (\n    <div>\n      <h4>This is a CMS sample, on the left is the CMS, and this is an example website.</h4>\n      <h2>This header cannot be edited.</h2>\n      <p id=\"description\" className=\"cp-editable\">{data.description}</p>\n      <div style={{padding:\"15px\",margin:\"auto\"}}>\n        <div id=\"name\" className=\"cp-editable\">{data.name}</div>\n        <div id=\"surname\" className=\"cp-editable\">{data.surname}</div>\n      </div>\n      <p>This paragraph cannot be edited because it doesn't have the className 'cp-editable', or an id to be linked to the object in the Firstore database. If you look at the example source code you'll see what can be edited and what can't.</p>\n\n      <h4>List of jobs</h4>\n      <ul>\n      {\n        data.jobs.map((job, i) => (\n          <li id={\"jobs-\"+i} className=\"cp-editable\" style={{lineHeight:\"2\"}}>{job}</li>\n        ))\n      }\n      </ul>\n      <h4>Careers</h4>\n      <div style={{display:\"flex\",justifyContent:\"flex-start\",flexWrap:\"wrap\"}}>\n      {\n        data.careers.map((career, i) => (\n          <div style={{padding: \"5px\",margin:\"15px 5px\",borderRadius:\"4px\",border:\"2px solid rgb(0,0,0,0.15)\",backgroundColor:\"rgb(245,245,245)\"}}>\n            <div id={\"careers-\"+i+\"-title\"} className=\"cp-editable\" style={{margin:\"10px 0\"}}>Position: {career.title}</div>\n            <div id={\"careers-\"+i+\"-duration\"} className=\"cp-editable\">Duration: {career.duration} years</div>\n          </div>\n        ))\n      }\n\n      <div>\n        <div id=\"details-volunteer_work\" className=\"cp-editable\">Activity: {data.details.volunteer_work}</div>\n        <div id=\"details-qualifications1\" className=\"cp-editable\">Qualification: {data.details.qualifications1}</div>\n        <div id=\"details-qualifications2\" className=\"cp-editable\">Qualification: {data.details.qualifications2}</div>\n        <div>\n          <p>This is a deep component with multiple children</p>\n          <div id=\"details-qualifications3-text\" className=\"cp-editable\">Qualification: {data.details.qualifications3.text}</div>\n          <div id=\"details-qualifications3-start\" className=\"cp-editable\">Start: {data.details.qualifications3.start}</div>\n          <div id=\"details-qualifications3-end\" className=\"cp-editable\">End: {data.details.qualifications3.end}</div>\n        </div>\n      </div>\n      </div>\n    </div>\n  );\n}\n\nconst App = () => {\n  return <CMS projectName=\"test\" children={<MyWebsite />} />\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}