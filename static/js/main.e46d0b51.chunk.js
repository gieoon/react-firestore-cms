(this["webpackJsonpreact-firestore-cms-example"]=this["webpackJsonpreact-firestore-cms-example"]||[]).push([[0],{163:function(e,t,a){e.exports=a(343)},170:function(e,t,a){},335:function(e,t,a){},336:function(e,t,a){},337:function(e,t,a){},338:function(e,t,a){},343:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),i=a(35),r=a.n(i),c=(a(170),a(45)),o=a(79),s=a(36),d=a(18),u=a.n(d),m=a(32),p=a(13),f=a(151),g=a(152),b=a(162),h=a(161),v=a(153),E=a(20),w=a(345),y=a(346),N=a(347),O=a(348),j=a(349),S=a(350),k=a(351),C=a(352),x=a(353),L=a(354),D=a(46),T=a.n(D),U=a(99),q=a(60),A=a(100),I=a.n(A),F=(a(271),a(157)),M=a.n(F),R=a(158),_=a.n(R),B=a(78),P=a.n(B);function V(e){var t=e.loading;e.loadingTexts;return l.a.createElement("div",null,l.a.createElement("div",{className:"Loading "+(t?"show":"")},l.a.createElement("div",{className:"double-bounce1"}),l.a.createElement("div",{className:"double-bounce2"})),l.a.createElement("div",{className:"Loading-overlay "+(t?"show":"")}))}var z=function(e){Object(b.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(f.a)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).editorValue=T.a.createEmptyValue(),e.state={value:e.editorValue,files:e.props.files,showDropdown:!1},e.onChange=function(t){e.setState({value:t}),e.props.onChange&&e.props.onChange(t.toString("html"))},e}return Object(g.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){this.props.initialValue!==e.initialValue&&this.setState({value:T.a.createValueFromString(this.props.initialValue,"html")})}},{key:"render",value:function(){var e=this;return l.a.createElement(T.a,{value:this.state.value,onChange:this.onChange,toolbarConfig:{display:["INLINE_STYLE_BUTTONS","BLOCK_TYPE_BUTTONS","BLOCK_TYPE_DROPDOWN","LINK_BUTTONS"],INLINE_STYLE_BUTTONS:[{label:"Bold",style:"BOLD",className:"custom-css-class"},{label:"Italic",style:"ITALIC"},{label:"Underline",style:"UNDERLINE"}],BLOCK_TYPE_DROPDOWN:[{label:"Normal",style:"unstyled"},{label:"Small Title",style:"header-three"},{label:"Medium Title",style:"header-two"},{label:"Large Title",style:"header-one"}],BLOCK_TYPE_BUTTONS:[{label:"UL",style:"unordered-list-item"},{label:"OL",style:"ordered-list-item"}]},customControls:[function(t,a,n){return e.props.files?l.a.createElement("div",{className:"link-file",onClick:function(){console.log("Link to file clicked: ",e.props.files),e.setState({showDropdown:!e.state.showDropdown})},style:{display:e.props.files.length?"inline-block":"none"}},e.state.showDropdown?l.a.createElement(w.a,null):"Link to a file",l.a.createElement("div",{className:"link-file-dropdown "+(e.state.showDropdown?"showing":"")},e.props.files.map((function(t,a){return l.a.createElement("div",{key:"link-file-"+a,onClick:function(){console.log("file selected: ",t);n.getSelection().getAnchorKey();var a=n.getCurrentContent().createEntity("LINK","MUTABLE",{url:"file:".concat(t.id),class:"file-link"}),l=a.getLastCreatedEntityKey(),i=U.EditorState.set(n,{currentContent:a}),r=new D.EditorValue(U.RichUtils.toggleLink(i,i.getSelection(),l,"html"));e.setState({value:r}),e.props.onChange(r.toString("html"))}},l.a.createElement("span",null,t.name))})))):""}]})}}]),a}(l.a.Component),K=function(e){return e&&e.seconds?new Date(1e3*e.seconds).toLocaleDateString("en-nz"):""},W="https://firebasestorage.googleapis.com";function G(e){var t=e.children,a=e.setFrameLoaded,i=Object(n.useState)(),r=Object(p.a)(i,2);r[0],r[1];return Object(n.useEffect)((function(){}),[]),l.a.createElement(M.a,{id:"editingFrame",height:"100%",width:"100%",contentDidMount:function(){console.log("Frame mounted!!!: "),a(!0)}},t)}var H={};function J(e){var t=e.projectName,a=e.db,i=e.frameLoaded;Object(n.useEffect)((function(){if(i){h();var e=setInterval((function(){c()}),1500),t=r().head,a=r().createElement("link");return a.type="text/css",a.rel="stylesheet",a.href="https://cdn.quilljs.com/1.3.6/quill.snow.css",t.appendChild(a),function(){t.removeChild(a),console.log("CLEARING INTERVAL"),clearInterval(e)}}}),[i]);var r=function(){var e=document.querySelector("#editingFrame");if(e)return e.contentDocument},c=function(){for(var e=0,t=Array.from(r().querySelectorAll(".cp-editable"));e<t.length;e++){var a=t[e];if(!a.querySelector(".cp-editable-btn")){console.log("Adding button");var n=r().createElement("div");n.classList.add("cp-editable-btn-wrapper");var l=r().createElement("div"),i=r().createElement("div");l.textContent="Edit",l.classList.add("cp-editable-btn"),i.classList.add("editor");var c=r().createElement("div");c.textContent="Save",c.classList.add("cp-editable-save-btn");var d=r().createElement("div");d.textContent="Cancel",d.classList.add("cp-editable-cancel-btn"),c.onclick=function(e){s(e)},d.onclick=function(e){o()},l.onclick=function(e){b(e)},a.appendChild(i),n.appendChild(l),n.appendChild(c),n.appendChild(d),a.appendChild(n)}}},o=function(e){var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),console.log("Cancel pressed"),console.log(H[P()(t)].getText()),t.querySelector(".ql-toolbar").style.display="none",t.querySelector(".ql-container").style.display="none",t.textContent=H[P()(t)].getText(),console.log("parentElement.textContent: ",t.textContent)},s=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,l,i,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.target.closest(".cp-editable")).classList.toggle("editing"),n=r().querySelector(".ql-editor").textContent,console.log("got text: ",n),a.textContent=n,l={name:"Jason",surname:"Briggs",description:"A paragraph that can be changed by pressing the edit button on the bottom right.",jobs:["Software Engineer","Automation Tester","Developer Operations","Marketing & Sales Coordinator","Test Analyst"],careers:[{title:"Automation Testing",duration:2},{title:"Junior Software Developer",duration:5},{title:"Senior Software Developer",duration:10}],details:{volunteer_work:"Working at the Orphanage",qualifications1:"Google Ads Master - 2020",qualifications2:"Google Ads Master - 2021",qualifications3:{text:"2019 Kickstart Coding Challenge - Bronze",start:"2019 Jan",end:"2019 Nov"}}},console.log("Loaded dbObj: ",l),i=a.id.split(/-|~/g),console.log("el.id: ",a.id),console.log("sections: ",i),c=f(a),d(l,i,c),console.log("Returned: ",l),e.next=16,p(l);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function e(t,a,n){if(1!==a.length)return e(t[a[0]],a.slice(1),n);t[a]=n},p=function(){var e=Object(m.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a.collection("CMS_WebsiteContent").doc(t).set(n).then((function(){return"Success"})).catch((function(e){return console.error("Error saving website content: ",e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(e){return console.log("Extracting text from: ",e,e.textContent),e.textContent.replace(/EditSaveCancel/,"")},g=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]],b=function(e){console.log("Creating edit input");var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),console.log("parentElement: ",t);var a=t.innerHTML.match(/^[^<]*/),n=a[0].trim(),l=new RegExp(a[0]);if(t.querySelector(".ql-toolbar"))t.querySelector(".ql-toolbar").style.display="block",t.querySelector(".ql-container").style.display="block",t.innerHTML=t.innerHTML.replace(l,"");else{var i=new _.a(t.querySelector(".editor"),{modules:{toolbar:g},theme:"snow"});i.setText(n),t.innerHTML=t.innerHTML.replace(l,""),H[P()(t)]=i}t.querySelector(".cp-editable-cancel-btn").onclick=function(e){o(e)},t.querySelector(".cp-editable-save-btn").onclick=function(e){s(e)}},h=function(){console.log("Highlighting everything!!!"),c();var e=r();console.log("root: ",e),e.head.insertAdjacentHTML("beforeend",'\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;\n                }\n                .cp-editable::after {\n                    content: "";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    bottom: -5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn {\n                    display: block;\n                }\n            </style>\n        ')};return l.a.createElement(l.a.Fragment,null)}E.a.initializeApp({apiKey:"AIzaSyBiw4ORAbMmxImx4qPGq9JAFtUI36PeYQ0",authDomain:"sheets2website-1598313088115.firebaseapp.com",databaseURL:"https://sheets2website-1598313088115.firebaseio.com",projectId:"sheets2website-1598313088115",storageBucket:"sheets2website-1598313088115.appspot.com",messagingSenderId:"1082271392691",appId:"1:1082271392691:web:45c06be046a0a72b5b21c6",measurementId:"G-ZWGE5NLZ4Z"});var Y=E.a.firestore();var Q=function(e){var t=e.entry,a=(e.projectName,e.sectionName,e.setShowingEdit),n=e.setShowingNew,i=e.setNewAudio,r=e.setNewImages,c=e.setNewFiles,o=e.setNewDate,s=e.setAdditionalDate,d=e.setNewTitle,u=e.setNewText,m=e.setShowingDeleteDialog,p=e.setRteInitTitle,f=e.setRteInitContent,g=e.setShowingAdditionalDate;return l.a.createElement("div",{className:"SectionContent"},l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"cms-media-wrapper"},t.images&&t.images.length?l.a.createElement(q.LazyLoadImage,{src:t.imageURL||t.images[0].url,effect:"blur",width:"260px",height:"fit-content",alt:""}):"",t.audio&&t.audio.length?l.a.createElement("audio",{controls:!0,src:t.audioURL||t.audio[0].url,type:".mp3,audio/*"}):"",t.files&&t.files.length?l.a.createElement("div",{className:"file"},l.a.createElement(C.a,null),l.a.createElement("p",null,t.files.length," resource",t.files.length>1?"s":"")):""),l.a.createElement("div",{className:"right-content"},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.title}}),l.a.createElement("div",{className:"date-display-container"},t.date&&l.a.createElement("p",{className:"date"},K(t.date)),t.additionalDate&&l.a.createElement("p",{className:"additionalDate"},K(t.additionalDate))),l.a.createElement("div",{className:"contents",dangerouslySetInnerHTML:{__html:t.content}}))),l.a.createElement("div",null,l.a.createElement("div",{className:"edit",onClick:function(){console.log("showing entry: ",t),a(t),n(!0),i(t.audio||[]),r(t.images||[]),c(t.files||[]),o(new Date(1e3*t.date.seconds)),t.additionalDate&&g(!0);var e=t.additionalDate?1e3*t.additionalDate.seconds:Date.now();s(new Date(e)),d(t.title||""),u(t.content||""),p(t.title||""),f(t.content||"")}},l.a.createElement(x.a,null)),l.a.createElement("div",{className:"delete",onClick:function(){m(t)}},l.a.createElement(L.a,null))))},Z=function(e){var t=e.projectName,a=e.children,i=Object(n.useState)(!1),r=Object(p.a)(i,2),d=r[0],f=r[1],g=Object(n.useState)(),b=Object(p.a)(g,2),h=b[0],C=b[1],x=Object(n.useState)({}),L=Object(p.a)(x,2),D=L[0],U=L[1],A=Object(n.useState)(""),F=Object(p.a)(A,2),M=F[0],R=F[1],_=Object(n.useState)(""),B=Object(p.a)(_,2),P=B[0],K=B[1],H=Object(n.useState)({sections:[]}),Z=Object(p.a)(H,2),X=Z[0],$=Z[1],ee=Object(n.useState)(0),te=Object(p.a)(ee,2),ae=te[0],ne=te[1],le=Object(n.useState)(!1),ie=Object(p.a)(le,2),re=ie[0],ce=ie[1],oe=Object(n.useState)(""),se=Object(p.a)(oe,2),de=se[0],ue=se[1],me=Object(n.useState)(""),pe=Object(p.a)(me,2),fe=pe[0],ge=pe[1],be=Object(n.useState)(new Date),he=Object(p.a)(be,2),ve=he[0],Ee=he[1],we=Object(n.useState)(!1),ye=Object(p.a)(we,2),Ne=ye[0],Oe=ye[1],je=Object(n.useState)(void 0),Se=Object(p.a)(je,2),ke=Se[0],Ce=Se[1],xe=Object(n.useState)(!1),Le=Object(p.a)(xe,2),De=Le[0],Te=Le[1],Ue=Object(n.useState)(!1),qe=Object(p.a)(Ue,2),Ae=qe[0],Ie=qe[1],Fe=Object(n.useState)(!1),Me=Object(p.a)(Fe,2),Re=Me[0],_e=Me[1],Be=Object(n.useState)([]),Pe=Object(p.a)(Be,2),Ve=Pe[0],ze=Pe[1],Ke=Object(n.useState)([]),We=Object(p.a)(Ke,2),Ge=We[0],He=We[1],Je=Object(n.useState)([]),Ye=Object(p.a)(Je,2),Qe=Ye[0],Ze=Ye[1],Xe=Object(n.useState)(),$e=Object(p.a)(Xe,2),et=$e[0],tt=$e[1],at=Object(n.useState)(),nt=Object(p.a)(at,2),lt=nt[0],it=nt[1],rt=Object(n.useState)(!1),ct=Object(p.a)(rt,2),ot=ct[0],st=ct[1],dt=Object(n.useState)(new Date),ut=Object(p.a)(dt,2),mt=ut[0],pt=ut[1],ft=Object(n.useState)(0),gt=Object(p.a)(ft,2),bt=gt[0],ht=gt[1],vt=Object(n.useState)(),Et=Object(p.a)(vt,2),wt=Et[0],yt=Et[1];Object(n.useEffect)((function(){h||(yt(E.a.storage().ref()),(new E.a.auth.GoogleAuthProvider).addScope("https://www.googleapis.com/auth/contacts.readonly"),E.a.auth().onAuthStateChanged((function(e){e?(R(e.email),U(e),f(!0),C(e.uid)):(f(!0),C(""),U(""),R(""))})),E.a.auth().setPersistence(E.a.auth.Auth.Persistence.LOCAL))}),[]);var Nt=function(){var e=new E.a.auth.GoogleAuthProvider;E.a.auth().signInWithPopup(e).then((function(e){})).catch((function(e){console.error("Error signing in: ",e)}))};Object(n.useEffect)((function(){h&&(Ot(),jt())}),[d,h]);var Ot=function(){Y&&Y.collection("CMS").doc(t).set({lastLogin:E.a.firestore.FieldValue.serverTimestamp()},{merge:!0}).then((function(e){console.log(e)})).catch((function(e){console.error("Error in authTest: ",e),E.a.auth().signOut()}))},jt=function(){St().then((function(e){e||!d?($(e||{sections:[]}),_e(e.webpageEditable),e.webpageEditable&&ht(0),Lt(e||{sections:[]}).then((function(e){})),e&&e.sections.length&&K(e.sections[0]||"")):E.a.auth().signOut()}))},St=function(){var e=Object(m.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y&&h&&d){e.next=2;break}return e.abrupt("return",{sections:[]});case 2:return e.abrupt("return",Y.collection("CMS").doc(t).get().then((function(e){e.get("email");return e.data()||{sections:[]}})).catch((function(e){console.error("Error reading user data: ",e)})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),kt=Object(n.useCallback)((function(){xt({})}),[]),Ct=Object(n.useState)(),xt=Object(p.a)(Ct,2)[1],Lt=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.sections){e.next=2;break}return e.abrupt("return");case 2:return a=[],n={},t.sections.forEach((function(e){a.push(Dt(e,t).then((function(t){n[e]=t})))})),e.abrupt("return",Promise.all(a).then((function(){return n})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Dt=function(){var e=Object(m.a)(u.a.mark((function e(a,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Y.collection("CMS").doc(t).collection(a).orderBy("date","desc").onSnapshot((function(e){e.docChanges().forEach((function(e){var t=n;if(t[a]||(t[a]={}),"added"===e.type||"modified"===e.type){var l=e.doc.data();l.imageURL&&(l.images=[{id:Date.now().toString(),url:l.imageURL,path:"",name:""}]),l.audioURL&&(l.audio=[{id:Date.now().toString(),url:l.audioURL,name:"",path:""}]),t[a][e.doc.id]=Object(s.a)(Object(s.a)({},l),{},{id:e.doc.id})}else"removed"===e.type&&delete t[a][e.doc.id];$(t),kt()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Tt=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.localFile){e.next=2;break}return e.abrupt("return",{url:t.url,path:t.path});case 2:return a={customMetadata:{uploader:M}},n=At("images",t.name),l=wt.child(n),e.abrupt("return",l.put(t.localFile,a).then((function(e){return console.log("Uploaded Image"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.localFile){e.next=2;break}return e.abrupt("return",{url:t.url,path:t.path});case 2:return a={customMetadata:{uploader:M}},n=At("audio",t.name),l=wt.child(n),e.abrupt("return",l.put(t.localFile,a).then((function(e){return console.log("Uploaded Audio"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})).catch((function(e){console.error("Error saving audio: ",e)})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qt=function(){var e=Object(m.a)(u.a.mark((function e(t){var a,n,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.localFile){e.next=2;break}return e.abrupt("return",{url:t.url,path:t.path});case 2:return a={customMetadata:{uploader:M}},n=At("miscellaneous",t.name),console.log("saving fileObj: ",t),l=wt.child(n),e.abrupt("return",l.put(t.localFile,a).then((function(e){return console.log("Uploaded miscellaneous"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})).catch((function(e){console.error("Error saving miscellaneous: ",e)})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),At=function(e,a){return t+"/"+e+"/"+a},It=function(){var e=Object(m.a)(u.a.mark((function e(){var a,n,l,i,r,c,o,d,m,p;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Oe(!0),tt("_"),it("_"),a=X.sections[ae],n=[],l=0;case 6:if(!(l<Ve.length)){e.next=19;break}if(!(Ve[l].downloadUrl||"").includes(W)){e.next=11;break}e.t0=Ve[l],e.next=14;break;case 11:return e.next=13,Tt(Ve[l]);case 13:e.t0=e.sent;case 14:i=e.t0,n.push(Object(s.a)(Object(s.a)({},i),{},{id:Ve[l].id,name:Ve[l].name}));case 16:l++,e.next=6;break;case 19:r=[],l=0;case 21:if(!(l<Qe.length)){e.next=34;break}if(!(Qe[l].downloadUrl||"").includes(W)){e.next=26;break}e.t1=Qe[l],e.next=29;break;case 26:return e.next=28,Ut(Qe[l]);case 28:e.t1=e.sent;case 29:c=e.t1,r.push(Object(s.a)(Object(s.a)({},c),{},{id:Qe[l].id,name:Qe[l].name}));case 31:l++,e.next=21;break;case 34:o=[],l=0;case 36:if(!(l<Ge.length)){e.next=49;break}if(!(Ge[l].downloadUrl||"").includes(W)){e.next=41;break}e.t2=Ge[l],e.next=44;break;case 41:return e.next=43,qt(Ge[l]);case 43:e.t2=e.sent;case 44:d=e.t2,o.push(Object(s.a)(Object(s.a)({},d),{},{id:Ge[l].id,name:Ge[l].name}));case 46:l++,e.next=36;break;case 49:(m={}).images=n||[],m.audio=r||[],m.files=o||[],fe&&(m.title=fe),de&&(m.content=de),m.date=ve||(new Date).toLocaleDateString("en-CA").toString(),m.additionalDate=ot&&mt?mt:"",m.createdOn=E.a.firestore.FieldValue.serverTimestamp(),p=ke?ke.id:Date.now().toString(),Y.collection("CMS").doc(t).collection(a).doc(p).set(m,{merge:!0}).then((function(){console.log("Successfully saved entry"),Oe(!1),ce(!1),Ce(void 0),tt(""),it(""),ge(""),ue(""),Ee(new Date),pt(new Date),Ze([]),ze([]),He([]),st(!1)})).catch((function(e){console.error("Error saving new entry: ",e),Oe(!1),ce(!1)}));case 60:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ft=function(){Ce(void 0),ce(!re),Ze([]),ze([]),Ee(new Date),He([]),pt(new Date),ge(""),st(!1),ue(""),tt(""),it("")},Mt=function(e,t){(t||"").includes(W)&&E.a.storage().refFromURL(t).delete().then((function(){})).catch((function(e){console.error("Error deleting stored item")}))};return l.a.createElement("div",{className:"CMS"},l.a.createElement(v.a,null,l.a.createElement("meta",{charSet:"utf-8"}),l.a.createElement("title",null,"Update your website"),l.a.createElement("link",{rel:"icon",type:"image/png",href:"blank.ico",sizes:"16x16"})),!h&&d&&l.a.createElement("div",{className:"overlay"},l.a.createElement("div",{className:"content"},l.a.createElement("h2",null,"Login to update your website"),l.a.createElement("p",null,"Please use your approved email address"),l.a.createElement("div",{className:"login",onClick:function(){Nt()}},l.a.createElement("span",null,"Login")))),l.a.createElement("div",{className:"inner"},l.a.createElement("div",{className:"left"},l.a.createElement("div",{className:"title"},l.a.createElement("h4",{className:"subtitle"},"Website Content Management"),l.a.createElement("h1",null,X.projectName)),Re?l.a.createElement("div",{className:"editType-wrapper "+(0===bt?"left-selected":"right-selected")},l.a.createElement("div",{className:0===bt?"selected":"",onClick:function(){return ht(0)}},"Page Content"),l.a.createElement("div",{className:1===bt?"selected":"",onClick:function(){return ht(1)}},"Dynamic Content")):"",0===bt?l.a.createElement("div",{className:"sections-wrapper"},l.a.createElement("div",{className:"section",style:{backgroundColor:"white"}},"Select text on the right to edit it.")):l.a.createElement("div",{className:"sections-wrapper"},X.sections&&X.sections.map((function(e,t){return l.a.createElement("div",{key:"left-section-"+t,className:"section "+(ae===t?"selected":""),onClick:function(){!function(e){K(X.sections[e]),ne(e)}(t)}},e)}))),l.a.createElement("div",{className:"profile"},D.photoURL?l.a.createElement(q.LazyLoadImage,{src:D.photoURL,effect:"blur",alt:""}):l.a.createElement(q.LazyLoadImage,{src:"profile~FlXvJqZg.png",effect:"blur",alt:""}),l.a.createElement("div",{className:"details-wrapper"},D.displayName?l.a.createElement("div",{className:"displayName"},l.a.createElement("span",null,D.displayName)):l.a.createElement("div",{onClick:function(){Nt()}}),D.email?l.a.createElement("div",{className:"email"},l.a.createElement("span",null,D.email)):l.a.createElement("div",null)),D?l.a.createElement(w.a,{onClick:function(){E.a.auth().signOut()}}):""),l.a.createElement("div",{className:"attribution"},l.a.createElement("span",null,"Website content management - Webbi\xa9 2020"))),l.a.createElement("div",{className:"right"},0===bt?l.a.createElement(G,{setFrameLoaded:Ie},a,l.a.createElement(J,{projectName:t,db:Y,frameLoaded:Ae})):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"top"},l.a.createElement("div",{className:"header"},X.sections&&l.a.createElement("h1",null,X.sections[ae])),l.a.createElement("div",{className:"wrapper",onClick:function(){ce(!re)}},re?l.a.createElement(w.a,{width:"48"}):l.a.createElement(y.a,{width:"48"}))),l.a.createElement("div",{className:"inner"},X.sections&&Object.values(X[P]||{}).map((function(e,a){return l.a.createElement(Q,{key:"inner-entry-"+a,entry:e,setShowingEdit:Ce,setShowingNew:ce,setNewAudio:Ze,setNewImages:ze,setNewFiles:He,setNewDate:Ee,setAdditionalDate:pt,setNewTitle:ge,setNewText:ue,setShowingDeleteDialog:Te,projectName:t,sectionName:P,setRteInitTitle:tt,setRteInitContent:it,setShowingAdditionalDate:st})}))))),l.a.createElement("div",{className:"overlay "+(re?"showing":""),onClick:function(){Ft()}}),l.a.createElement("div",{className:"modal "+(re?"showing":"")},l.a.createElement("div",{className:"title"},l.a.createElement("div",null,l.a.createElement(w.a,{onClick:function(){Ft()}}),X.sections?ke?l.a.createElement("h1",null,"Edit ",P.toString().toLowerCase()):l.a.createElement("h1",null,"Create ",P.toString().toLowerCase()):""),l.a.createElement("div",null,l.a.createElement("div",{className:"save ok",onClick:function(){It()}},l.a.createElement("span",null,"Save")))),l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"media-upload-wrapper"},l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"image-upload"},l.a.createElement("div",{className:"image-upload-wrapper"},l.a.createElement(N.a,null))),l.a.createElement("input",{id:"image-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("image added: ",t),t&&e.target.files.length&&ze([].concat(Object(o.a)(Ve||[]),[{id:Date.now().toString(),url:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:"image/*",onClick:function(e){e.target.value=""}})),l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"audio-upload"},l.a.createElement("div",{className:"audio-upload-wrapper"},l.a.createElement(O.a,null))),l.a.createElement("input",{id:"audio-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("audio added: ",t),t&&e.target.files.length&&Ze([].concat(Object(o.a)(Qe||[]),[{id:Date.now().toString(),url:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:".mp3,.aif,.aiff,.ogg,.wav,audio/*",onClick:function(e){e.target.value=""}})),l.a.createElement("label",{htmlFor:"file-upload"},l.a.createElement("div",{className:"file-upload-wrapper"},l.a.createElement(j.a,null))),l.a.createElement("input",{id:"file-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("file added: ",t),t&&e.target.files.length&&He([].concat(Object(o.a)(Ge||[]),[{id:Date.now().toString(),downloadUrl:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:"application/pdf,application/msword,text/plain,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onClick:function(e){e.target.value=""}})),l.a.createElement("div",{className:"uploaded-previews box"},Ve&&Ve.length?l.a.createElement("div",null,Ve.map((function(e,t){return l.a.createElement("div",{className:"uploaded-img-wrapper",key:"img-"+t},l.a.createElement(q.LazyLoadImage,{className:"uploaded-img",src:e.url,effect:"blur",alt:""}),l.a.createElement("div",{onClick:function(){var t;t=e.url,Mt("image",t),ze(Ve.filter((function(e){return e.url!==t})))}},l.a.createElement(w.a,null)))}))):"",Qe&&Qe.length?l.a.createElement("div",null,Qe.map((function(e,t){return l.a.createElement("div",{className:"uploaded-audio-wrapper",key:"audio-"+t},l.a.createElement("audio",{controls:!0,className:"uploaded-audio",src:e.url,type:".mp3,audio/*"}),l.a.createElement("div",{onClick:function(){var t;t=e.url,Mt("audio",t),Ze(Qe.filter((function(e){return e.url!==t})))}},l.a.createElement(w.a,null)))}))):"",Ge&&Ge.length?l.a.createElement("div",null,Ge.map((function(e,t){return l.a.createElement("div",{className:"uploaded-miscellaneous-wrapper",key:"miscellaneous-"+t},l.a.createElement("div",null,l.a.createElement("a",{href:e.downloadUrl||e.url,download:e.name},e.name)),l.a.createElement("div",{onClick:function(){return t=e.url,console.log("removing fileId: ",t),console.log("newFiles: ",Ge),Mt("miscellaneous",t),void He(Ge.filter((function(e){return e.url!==t})));var t}},l.a.createElement(w.a,null)))}))):""),l.a.createElement("div",{className:"box"},l.a.createElement("div",{className:"date-wrapper"},l.a.createElement("h4",null,"Date"),l.a.createElement("div",{className:"svg-wrapper",onClick:function(){st(!ot)}},l.a.createElement("label",null,"Using a date range"),l.a.createElement("div",{className:"svg-wrapper-inner "+(ot?"showing":"")},ot?l.a.createElement(S.a,null):l.a.createElement(k.a,null)))),l.a.createElement(I.a,{onChange:function(e){Ee(e)},selected:ve,dateFormat:"yyyy-MM-dd"}),ot&&l.a.createElement("div",{id:"additional-datepicker"},l.a.createElement(I.a,{onChange:function(e){pt(e)},selected:mt,dateFormat:"yyyy-MM-dd"}))),l.a.createElement("div",{className:"title-upload box"},l.a.createElement("h4",null,"Title"),l.a.createElement(z,{initialValue:et,value:T.a.createValueFromString(fe,"html"),onChange:function(e){ge(e)}})),l.a.createElement("div",{className:"text-upload box"},l.a.createElement("h4",null,"Content"),l.a.createElement(z,{initialValue:lt,value:T.a.createValueFromString(de,"html"),onChange:function(e){ue(e)},files:Ge}))),l.a.createElement(V,{loading:Ne})),l.a.createElement("div",{className:"overlay "+(De?"showing":""),onClick:function(){Te(!1)}}),l.a.createElement("div",{className:"deleteDialog "+(De?"showing":"")},l.a.createElement("h4",null,"Are you sure you want to delete this?"),l.a.createElement("div",{className:"options-wrapper"},l.a.createElement("div",{className:"cancel",onClick:function(){Te(!1)}},l.a.createElement("span",null,"Cancel")),l.a.createElement("div",{className:"ok",onClick:function(){!function(e,t,a){if(Ve.length){var n,l=Object(c.a)(Ve);try{for(l.s();!(n=l.n()).done;){var i=n.value;Mt("image",i.downloadUrl)}}catch(h){l.e(h)}finally{l.f()}}if(Qe.length){var r,o=Object(c.a)(Qe);try{for(o.s();!(r=o.n()).done;){i=r.value;Mt("audio",i.downloadUrl)}}catch(h){o.e(h)}finally{o.f()}}if(Ge.length){var s,d=Object(c.a)(Ge);try{for(d.s();!(s=d.n()).done;){i=s.value;Mt("miscellaneous",i.downloadUrl)}}catch(h){d.e(h)}finally{d.f()}}if(e.images&&e.images.length){var u,m=Object(c.a)(e.images);try{for(m.s();!(u=m.n()).done;){i=u.value;Mt("image",i.url)}}catch(h){m.e(h)}finally{m.f()}}if(e.audio&&e.audio.length){var p,f=Object(c.a)(e.audio);try{for(f.s();!(p=f.n()).done;){i=p.value;Mt("audio",i.url)}}catch(h){f.e(h)}finally{f.f()}}if(e.files&&e.files.length){var g,b=Object(c.a)(e.files);try{for(b.s();!(g=b.n()).done;){i=g.value;Mt("miscellaneous",i.url)}}catch(h){b.e(h)}finally{b.f()}}Y.collection("CMS").doc(t).collection(a).doc(e.id).delete().then((function(){})).catch((function(e){console.error("Error deleting entry: ",e)}))}(De,t,P),Te(!1)}},l.a.createElement("span",null,"Ok"))))))},X=(a(335),a(336),a(337),a(338),function(){var e={name:"Jason",surname:"Briggs",description:"This is a paragraph that can be changed by pressing the edit button on the bottom right.",jobs:["Software Engineer","Automation Tester","Developer Operations","Marketing & Sales Coordinator","Test Analyst"],careers:[{title:"Automation Testing",duration:2},{title:"Junior Software Developer",duration:5},{title:"Senior Software Developer",duration:10}],details:{volunteer_work:"Working at the Orphanage",qualifications1:"Google Ads Master - 2020",qualifications2:"Google Ads Master - 2021",qualifications3:{text:"2019 Kickstart Coding Challenge - Bronze",start:"2019 Jan",end:"2019 Nov"}}};return l.a.createElement("div",null,l.a.createElement("h4",null,"This is a CMS sample, on the left is the CMS, and this is an example website."),l.a.createElement("h2",null,"This header cannot be edited."),l.a.createElement("p",{id:"description",className:"cp-editable"},e.description),l.a.createElement("div",{style:{padding:"15px",margin:"auto"}},l.a.createElement("div",{id:"name",className:"cp-editable"},e.name),l.a.createElement("div",{id:"surname",className:"cp-editable"},e.surname)),l.a.createElement("p",null,"This paragraph cannot be edited because it doesn't have the className 'cp-editable', or an id to be linked to the object in the Firstore database. If you look at the example source code you'll see what can be edited and what can't."),l.a.createElement("h4",null,"List of jobs"),l.a.createElement("ul",null,e.jobs.map((function(e,t){return l.a.createElement("li",{id:"jobs-"+t,className:"cp-editable",style:{lineHeight:"2"}},e)}))),l.a.createElement("h4",null,"Careers"),l.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap"}},e.careers.map((function(e,t){return l.a.createElement("div",{style:{padding:"5px",margin:"15px 5px",borderRadius:"4px",border:"2px solid rgb(0,0,0,0.15)",backgroundColor:"rgb(245,245,245)"}},l.a.createElement("div",{id:"careers-"+t+"-title",className:"cp-editable",style:{margin:"10px 0"}},"Position: ",e.title),l.a.createElement("div",{id:"careers-"+t+"-duration",className:"cp-editable"},"Duration: ",e.duration," years"))})),l.a.createElement("div",null,l.a.createElement("div",{id:"details-volunteer_work",className:"cp-editable"},"Activity: ",e.details.volunteer_work),l.a.createElement("div",{id:"details-qualifications1",className:"cp-editable"},"Qualification: ",e.details.qualifications1),l.a.createElement("div",{id:"details-qualifications2",className:"cp-editable"},"Qualification: ",e.details.qualifications2),l.a.createElement("div",null,l.a.createElement("p",null,"This is a deep component with multiple children"),l.a.createElement("div",{id:"details-qualifications3-text",className:"cp-editable"},"Qualification: ",e.details.qualifications3.text),l.a.createElement("div",{id:"details-qualifications3-start",className:"cp-editable"},"Start: ",e.details.qualifications3.start),l.a.createElement("div",{id:"details-qualifications3-end",className:"cp-editable"},"End: ",e.details.qualifications3.end)))))}),$=function(){return l.a.createElement(Z,{projectName:"test",children:l.a.createElement(X,null)})};r.a.render(l.a.createElement($,null),document.getElementById("root"))}},[[163,1,2]]]);
//# sourceMappingURL=main.e46d0b51.chunk.js.map