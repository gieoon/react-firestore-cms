(this["webpackJsonpreact-firestore-cms-example"]=this["webpackJsonpreact-firestore-cms-example"]||[]).push([[0],{150:function(e,t,n){e.exports=n(330)},157:function(e,t,n){},323:function(e,t,n){},324:function(e,t,n){},325:function(e,t,n){},326:function(e,t,n){},330:function(e,t,n){"use strict";n.r(t);var a=n(2),l=n.n(a),i=n(30),r=n.n(i),o=n(149),c=(n(157),n(70)),s=n(142),d=n(333),u=n(334),m=n(335),p=n(336),f=n(337),h=n(338),g=n(339),v=n(340),b=n(341),E=n(342),y=n(39),w=n.n(y),N=n(90),S=n(51),C=n(91),L=n.n(C),k=(n(257),n(145)),j=n.n(k),O=n(146),x=n.n(O),D=n(69),T=n.n(D);function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function A(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var q=function(){function e(){}return e.prototype.then=function(t,n){var a=new e,l=this.s;if(l){var i=1&l?t:n;if(i){try{F(a,1,i(this.v))}catch(r){F(a,2,r)}return a}return this}return this.o=function(e){try{var l=e.v;1&e.s?F(a,1,t?t(l):l):n?F(a,1,n(l)):F(a,2,l)}catch(r){F(a,2,r)}},a},e}();function F(e,t,n){if(!e.s){if(n instanceof q){if(!n.s)return void(n.o=F.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(F.bind(null,e,t),F.bind(null,e,2));e.s=t,e.v=n;var a=e.o;a&&a(e)}}function R(e){return e instanceof q&&1&e.s}function M(e,t,n){var a,l,i=-1;return function r(o){try{for(;++i<e.length&&(!n||!n());)if((o=t(i))&&o.then){if(!R(o))return void o.then(r,l||(l=F.bind(null,a=new q,2)));o=o.v}a?F(a,1,o):a=o}catch(c){F(a||(a=new q),2,c)}}(),a}"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function _(e){var t=e.loading;return l.a.createElement("div",null,l.a.createElement("div",{className:"Loading "+(t?"show":"")},l.a.createElement("div",{className:"double-bounce1"}),l.a.createElement("div",{className:"double-bounce2"})),l.a.createElement("div",{className:"Loading-overlay "+(t?"show":"")}))}var B=function(e){var t,n;function a(){for(var t,n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return(t=e.call.apply(e,[this].concat(a))||this).editorValue=w.a.createEmptyValue(),t.state={value:t.editorValue,files:t.props.files,showDropdown:!1},t.onChange=function(e){t.setState({value:e}),t.props.onChange&&t.props.onChange(e.toString("html"))},t}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,U(t,n);var i=a.prototype;return i.componentDidUpdate=function(e,t,n){this.props.initialValue!==e.initialValue&&this.setState({value:w.a.createValueFromString(this.props.initialValue,"html")})},i.render=function(){var e=this;return l.a.createElement(w.a,{value:this.state.value,onChange:this.onChange,toolbarConfig:{display:["INLINE_STYLE_BUTTONS","BLOCK_TYPE_BUTTONS","BLOCK_TYPE_DROPDOWN","LINK_BUTTONS"],INLINE_STYLE_BUTTONS:[{label:"Bold",style:"BOLD",className:"custom-css-class"},{label:"Italic",style:"ITALIC"},{label:"Underline",style:"UNDERLINE"}],BLOCK_TYPE_DROPDOWN:[{label:"Normal",style:"unstyled"},{label:"Small Title",style:"header-three"},{label:"Medium Title",style:"header-two"},{label:"Large Title",style:"header-one"}],BLOCK_TYPE_BUTTONS:[{label:"UL",style:"unordered-list-item"},{label:"OL",style:"ordered-list-item"}]},customControls:[function(t,n,a){return e.props.files?l.a.createElement("div",{className:"link-file",onClick:function(){console.log("Link to file clicked: ",e.props.files),e.setState({showDropdown:!e.state.showDropdown})},style:{display:e.props.files.length?"inline-block":"none"}},e.state.showDropdown?l.a.createElement(d.a,null):"Link to a file",l.a.createElement("div",{className:"link-file-dropdown "+(e.state.showDropdown?"showing":"")},e.props.files.map((function(t,n){return l.a.createElement("div",{key:"link-file-"+n,onClick:function(){console.log("file selected: ",t);a.getSelection().getAnchorKey();var n=a.getCurrentContent().createEntity("LINK","MUTABLE",{url:"file:"+t.id,class:"file-link"}),l=n.getLastCreatedEntityKey(),i=N.EditorState.set(a,{currentContent:n}),r=new y.EditorValue(N.RichUtils.toggleLink(i,i.getSelection(),l,"html"));e.setState({value:r}),e.props.onChange(r.toString("html"))}},l.a.createElement("span",null,t.name))})))):""}]})},a}(l.a.Component),V=function(e){return e&&e.seconds?new Date(1e3*e.seconds).toLocaleDateString("en-nz"):""},W="https://firebasestorage.googleapis.com";function z(e){var t=e.children,n=e.setFrameLoaded;Object(a.useState)();return Object(a.useEffect)((function(){}),[]),l.a.createElement(j.a,{id:"editingFrame",height:"100%",width:"100%",contentDidMount:function(){n(!0)}},t)}var K={};function H(e){var t=e.projectName,n=e.collectionWebsiteContent,i=e.db,r=e.frameLoaded;Object(a.useEffect)((function(){if(r){v();var e=setInterval((function(){c()}),1500),t=o().head,n=o().createElement("link");return n.type="text/css",n.rel="stylesheet",n.href="https://cdn.quilljs.com/1.3.6/quill.snow.css",t.appendChild(n),function(){t.removeChild(n),console.log("CLEARING INTERVAL"),clearInterval(e)}}}),[r]);var o=function(){var e=document.querySelector("#editingFrame");if(e)return e.contentDocument},c=function(){for(var e=0,t=Array.from(o().querySelectorAll(".cp-editable"));e<t.length;e++){var n=t[e];if(!n.querySelector(".cp-editable-btn")){var a=o().createElement("div");a.classList.add("cp-editable-btn-wrapper");var l=o().createElement("div"),i=o().createElement("div");l.textContent="Edit",l.classList.add("cp-editable-btn"),i.classList.add("editor");var r=o().createElement("div");r.textContent="Save",r.classList.add("cp-editable-save-btn");var c=o().createElement("div");c.textContent="Cancel",c.classList.add("cp-editable-cancel-btn"),r.onclick=function(e){d(e)},c.onclick=function(e){s()},l.onclick=function(e){g(e)},n.appendChild(i),a.appendChild(l),a.appendChild(r),a.appendChild(c),n.appendChild(a)}}},s=function(e){var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),console.log("Cancel pressed"),console.log(K[T()(t)].getText()),t.querySelector(".ql-toolbar").style.display="none",t.querySelector(".ql-container").style.display="none",t.textContent=K[T()(t)].getText(),console.log("parentElement.textContent: ",t.textContent)},d=function(e){try{var t=e.target.closest(".cp-editable");t.classList.toggle("editing");var n=o().querySelector(".ql-editor").textContent;console.log("got text: ",n),t.textContent=n;return Promise.resolve(m()).then((function(e){console.log("Loaded dbObj: ",e);var n=t.id.split(/-|~/g);console.log("el.id: ",t.id),console.log("sections: ",n);var a=f(t);return u(e,n,a),console.log("Returned: ",e),Promise.resolve(p(e)).then((function(){}))}))}catch(e){return Promise.reject(e)}},u=function e(t,n,a){if(1!==n.length)return e(t[n[0]],n.slice(1),a);t[n]=a},m=function(){try{return Promise.resolve(i.collection(n).doc(t).get().then((function(e){return console.log(e.data()),e.data()})).catch((function(e){return console.error("Error loading website content: ",e)})))}catch(e){return Promise.reject(e)}},p=function(e){try{return Promise.resolve(i.collection(n).doc(t).set(e).then((function(){return"Success"})).catch((function(e){return console.error("Error saving website content: ",e)})))}catch(a){return Promise.reject(a)}},f=function(e){return console.log("Extracting text from: ",e,e.textContent),e.textContent.replace(/EditSaveCancel/,"")},h=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]],g=function(e){console.log("Creating edit input");var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),console.log("parentElement: ",t);var n=t.innerHTML.match(/^[^<]*/),a=n[0].trim(),l=new RegExp(n[0]);if(t.querySelector(".ql-toolbar"))t.querySelector(".ql-toolbar").style.display="block",t.querySelector(".ql-container").style.display="block",t.innerHTML=t.innerHTML.replace(l,"");else{var i=new x.a(t.querySelector(".editor"),{modules:{toolbar:h},theme:"snow"});i.setText(a),t.innerHTML=t.innerHTML.replace(l,""),K[T()(t)]=i}t.querySelector(".cp-editable-cancel-btn").onclick=function(e){s(e)},t.querySelector(".cp-editable-save-btn").onclick=function(e){d(e)}},v=function(){c(),o().head.insertAdjacentHTML("beforeend",'\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;\n                }\n                .cp-editable::after {\n                    content: "";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    bottom: -5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn {\n                    display: block;\n                }\n            </style>\n        ')};return l.a.createElement(l.a.Fragment,null)}var G=function(e){var t=e.entry,n=e.setShowingEdit,a=e.setShowingNew,i=e.setNewAudio,r=e.setNewImages,o=e.setNewFiles,c=e.setNewDate,s=e.setAdditionalDate,d=e.setNewTitle,u=e.setNewText,m=e.setShowingDeleteDialog,p=e.setRteInitTitle,f=e.setRteInitContent,h=e.setShowingAdditionalDate;return l.a.createElement("div",{className:"SectionContent"},l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"cms-media-wrapper"},t.images&&t.images.length?l.a.createElement(S.LazyLoadImage,{src:t.imageURL||t.images[0].url,effect:"blur",width:"260px",height:"fit-content",alt:""}):"",t.audio&&t.audio.length?l.a.createElement("audio",{controls:!0,src:t.audioURL||t.audio[0].url,type:".mp3,audio/*"}):"",t.files&&t.files.length?l.a.createElement("div",{className:"file"},l.a.createElement(v.a,null),l.a.createElement("p",null,t.files.length," resource",t.files.length>1?"s":"")):""),l.a.createElement("div",{className:"right-content"},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.title}}),l.a.createElement("div",{className:"date-display-container"},t.date&&l.a.createElement("p",{className:"date"},V(t.date)),t.additionalDate&&l.a.createElement("p",{className:"additionalDate"},V(t.additionalDate))),l.a.createElement("div",{className:"contents",dangerouslySetInnerHTML:{__html:t.content}}))),l.a.createElement("div",null,l.a.createElement("div",{className:"edit",onClick:function(){console.log("showing entry: ",t),n(t),a(!0),i(t.audio||[]),r(t.images||[]),o(t.files||[]),c(new Date(1e3*t.date.seconds)),t.additionalDate&&h(!0);var e=t.additionalDate?1e3*t.additionalDate.seconds:Date.now();s(new Date(e)),d(t.title||""),u(t.content||""),p(t.title||""),f(t.content||"")}},l.a.createElement(b.a,null)),l.a.createElement("div",{className:"delete",onClick:function(){m(t)}},l.a.createElement(E.a,null))))},J=function(e){var t=e.db,n=e.firebase,i=e.projectName,r=e.collectionName,o=e.collectionWebsiteContent,c=e.children;Object(a.useEffect)((function(){}),[]);var v=Object(a.useState)(!1),b=v[0],E=v[1],y=Object(a.useState)(),N=y[0],C=y[1],k=Object(a.useState)({}),j=k[0],O=k[1],x=Object(a.useState)(""),D=x[0],T=x[1],U=Object(a.useState)(""),I=U[0],V=U[1],K=Object(a.useState)({sections:[]}),J=K[0],Y=K[1],Q=Object(a.useState)(0),Z=Q[0],X=Q[1],$=Object(a.useState)(!1),ee=$[0],te=$[1],ne=Object(a.useState)(""),ae=ne[0],le=ne[1],ie=Object(a.useState)(""),re=ie[0],oe=ie[1],ce=Object(a.useState)(new Date),se=ce[0],de=ce[1],ue=Object(a.useState)(!1),me=ue[0],pe=ue[1],fe=Object(a.useState)(void 0),he=fe[0],ge=fe[1],ve=Object(a.useState)(!1),be=ve[0],Ee=ve[1],ye=Object(a.useState)(!1),we=ye[0],Ne=ye[1],Se=Object(a.useState)(!1),Ce=Se[0],Le=Se[1],ke=Object(a.useState)([]),je=ke[0],Oe=ke[1],xe=Object(a.useState)([]),De=xe[0],Te=xe[1],Pe=Object(a.useState)([]),Ue=Pe[0],Ie=Pe[1],Ae=Object(a.useState)(),qe=Ae[0],Fe=Ae[1],Re=Object(a.useState)(),Me=Re[0],_e=Re[1],Be=Object(a.useState)(!1),Ve=Be[0],We=Be[1],ze=Object(a.useState)(new Date),Ke=ze[0],He=ze[1],Ge=Object(a.useState)(0),Je=Ge[0],Ye=Ge[1],Qe=Object(a.useState)(),Ze=Qe[0],Xe=Qe[1];Object(a.useEffect)((function(){N||(Xe(n.storage().ref()),(new n.auth.GoogleAuthProvider).addScope("https://www.googleapis.com/auth/contacts.readonly"),n.auth().onAuthStateChanged((function(e){e?(T(e.email),O(e),E(!0),C(e.uid)):(E(!0),C(""),O(""),T(""))})),n.auth().setPersistence(n.auth.Auth.Persistence.LOCAL))}),[]);var $e=function(){var e=new n.auth.GoogleAuthProvider;n.auth().signInWithPopup(e).then((function(e){})).catch((function(e){console.error("Error signing in: ",e)}))};Object(a.useEffect)((function(){N&&(et(),tt())}),[b,N]);var et=function(){t&&t.collection(r).doc(i).set({lastLogin:n.firestore.FieldValue.serverTimestamp()},{merge:!0}).then((function(e){})).catch((function(e){console.error("Error in authTest: ",e),n.auth().signOut()}))},tt=function(){nt().then((function(e){e||!b?(Y(e||{sections:[]}),Le(e.webpageEditable),e.webpageEditable&&Ye(0),it(e||{sections:[]}).then((function(e){})),e&&e.sections.length&&V(e.sections[0]||"")):n.auth().signOut()}))},nt=function(){try{return t&&N&&b?Promise.resolve(t.collection(r).doc(i).get().then((function(e){e.get("email");return e.data()||{sections:[]}})).catch((function(e){console.error("Error reading user data: ",e)}))):Promise.resolve({sections:[]})}catch(e){return Promise.reject(e)}},at=Object(a.useCallback)((function(){lt({})}),[]),lt=Object(a.useState)()[1],it=function(e){try{if(!e.sections)return Promise.resolve();var t=[],n={};return e.sections.forEach((function(a){t.push(rt(a,e).then((function(e){n[a]=e})))})),Promise.all(t).then((function(){return n}))}catch(a){return Promise.reject(a)}},rt=function(e,n){try{return Promise.resolve(t.collection(r).doc(i).collection(e).orderBy("date","desc").onSnapshot((function(t){t.docChanges().forEach((function(t){var a=n;if(a[e]||(a[e]={}),"added"===t.type||"modified"===t.type){var l=t.doc.data();l.imageURL&&(l.images=[{id:Date.now().toString(),url:l.imageURL,path:"",name:""}]),l.audioURL&&(l.audio=[{id:Date.now().toString(),url:l.audioURL,name:"",path:""}]),a[e][t.doc.id]=P({},l,{id:t.doc.id})}else"removed"===t.type&&delete a[e][t.doc.id];Y(a),at()}))})))}catch(a){return Promise.reject(a)}},ot=function(e,t){return i+"/"+e+"/"+t},ct=function(){try{var e=function(){function e(){function e(){var e={};e.images=l||[],e.audio=o||[],e.files=c||[],re&&(e.title=re),ae&&(e.content=ae),e.date=se||(new Date).toLocaleDateString("en-CA").toString(),e.additionalDate=Ve&&Ke?Ke:"",e.createdOn=n.firestore.FieldValue.serverTimestamp();var s=he?he.id:Date.now().toString();t.collection(r).doc(i).collection(a).doc(s).set(e,{merge:!0}).then((function(){console.log("Successfully saved entry"),pe(!1),te(!1),ge(void 0),Fe(""),_e(""),oe(""),le(""),de(new Date),He(new Date),Ie([]),Oe([]),Te([]),We(!1)})).catch((function(e){console.error("Error saving new entry: ",e),pe(!1),te(!1)}))}var c=[],s=M(De,(function(e){function t(t){c.push(P({},t,{id:De[e].id,name:De[e].name}))}return(De[e].downloadUrl||"").includes(W)?t(De[e]):Promise.resolve(function(e){try{if(!e.localFile)return Promise.resolve({url:e.url,path:e.path});var t={customMetadata:{uploader:D}},n=ot("miscellaneous",e.name);console.log("saving fileObj: ",e);var a=Ze.child(n);return Promise.resolve(a.put(e.localFile,t).then((function(e){return console.log("Uploaded miscellaneous"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})).catch((function(e){console.error("Error saving miscellaneous: ",e)})))}catch(l){return Promise.reject(l)}}(De[e])).then(t)}));return s&&s.then?s.then(e):e()}var o=[],c=0,s=function(e,t,n){for(var a;;){var l=e();if(R(l)&&(l=l.v),!l)return i;if(l.then){a=0;break}var i=n();if(i&&i.then){if(!R(i)){a=1;break}i=i.s}if(t){var r=t();if(r&&r.then&&!R(r)){a=2;break}}}var o=new q,c=F.bind(null,o,2);return(0===a?l.then(d):1===a?i.then(s):r.then(u)).then(void 0,c),o;function s(a){i=a;do{if(t&&(r=t())&&r.then&&!R(r))return void r.then(u).then(void 0,c);if(!(l=e())||R(l)&&!l.v)return void F(o,1,i);if(l.then)return void l.then(d).then(void 0,c);R(i=n())&&(i=i.v)}while(!i||!i.then);i.then(s).then(void 0,c)}function d(e){e?(i=n())&&i.then?i.then(s).then(void 0,c):s(i):F(o,1,i)}function u(){(l=e())?l.then?l.then(d).then(void 0,c):d(l):F(o,1,i)}}((function(){return c<Ue.length}),(function(){return c++}),(function(){function e(e){o.push(P({},e,{id:Ue[c].id,name:Ue[c].name}))}return(Ue[c].downloadUrl||"").includes(W)?e(Ue[c]):Promise.resolve(function(e){try{if(!e.localFile)return Promise.resolve({url:e.url,path:e.path});var t={customMetadata:{uploader:D}},n=ot("audio",e.name),a=Ze.child(n);return Promise.resolve(a.put(e.localFile,t).then((function(e){return console.log("Uploaded Audio"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})).catch((function(e){console.error("Error saving audio: ",e)})))}catch(l){return Promise.reject(l)}}(Ue[c])).then(e)}));return s&&s.then?s.then(e):e()};pe(!0),Fe("_"),_e("_");var a=J.sections[Z],l=[],o=M(je,(function(e){function t(t){l.push(P({},t,{id:je[e].id,name:je[e].name}))}return(je[e].downloadUrl||"").includes(W)?t(je[e]):Promise.resolve(function(e){try{if(!e.localFile)return Promise.resolve({url:e.url,path:e.path});var t={customMetadata:{uploader:D}},n=ot("images",e.name),a=Ze.child(n);return Promise.resolve(a.put(e.localFile,t).then((function(e){return console.log("Uploaded Image"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})))}catch(l){return Promise.reject(l)}}(je[e])).then(t)}));return Promise.resolve(o&&o.then?o.then(e):e())}catch(c){return Promise.reject(c)}},st=function(){ge(void 0),te(!ee),Ie([]),Oe([]),de(new Date),Te([]),He(new Date),oe(""),We(!1),le(""),Fe(""),_e("")},dt=function(e,t){(t||"").includes(W)&&n.storage().refFromURL(t).delete().then((function(){})).catch((function(e){console.error("Error deleting stored item")}))};return l.a.createElement("div",{className:"CMS"},l.a.createElement(s.a,null,l.a.createElement("meta",{charSet:"utf-8"}),l.a.createElement("title",null,"Update your website"),l.a.createElement("link",{rel:"icon",type:"image/png",href:"blank.ico",sizes:"16x16"})),!N&&b&&l.a.createElement("div",{className:"overlay"},l.a.createElement("div",{className:"content"},l.a.createElement("h2",null,"Login to update your website"),l.a.createElement("p",null,"Please use your approved email address"),l.a.createElement("div",{className:"login",onClick:function(){$e()}},l.a.createElement("span",null,"Login")))),l.a.createElement("div",{className:"inner"},l.a.createElement("div",{className:"left"},l.a.createElement("div",{className:"title"},l.a.createElement("h4",{className:"subtitle"},"Website Content Management"),l.a.createElement("h1",null,J.projectName)),Ce?l.a.createElement("div",{className:"editType-wrapper "+(0===Je?"left-selected":"right-selected")},l.a.createElement("div",{className:0===Je?"selected":"",onClick:function(){return Ye(0)}},"Page Content"),l.a.createElement("div",{className:1===Je?"selected":"",onClick:function(){return Ye(1)}},"Dynamic Content")):"",0===Je?l.a.createElement("div",{className:"sections-wrapper"},l.a.createElement("div",{className:"section",style:{backgroundColor:"white"}},"Select text on the right to edit it.")):l.a.createElement("div",{className:"sections-wrapper"},J.sections&&J.sections.map((function(e,t){return l.a.createElement("div",{key:"left-section-"+t,className:"section "+(Z===t?"selected":""),onClick:function(){!function(e){V(J.sections[e]),X(e)}(t)}},e)}))),l.a.createElement("div",{className:"profile"},j.photoURL?l.a.createElement(S.LazyLoadImage,{src:j.photoURL,effect:"blur",alt:""}):l.a.createElement(S.LazyLoadImage,{src:"profile~FlXvJqZg.png",effect:"blur",alt:""}),l.a.createElement("div",{className:"details-wrapper"},j.displayName?l.a.createElement("div",{className:"displayName"},l.a.createElement("span",null,j.displayName)):l.a.createElement("div",{onClick:function(){$e()}}),j.email?l.a.createElement("div",{className:"email"},l.a.createElement("span",null,j.email)):l.a.createElement("div",null)),j?l.a.createElement(d.a,{onClick:function(){n.auth().signOut()}}):""),l.a.createElement("div",{className:"attribution"},l.a.createElement("span",null,"Website content management - Webbi\xa9 2020"))),l.a.createElement("div",{className:"right"},0===Je?l.a.createElement(z,{setFrameLoaded:Ne},c,l.a.createElement(H,{projectName:i,collectionWebsiteContent:o,db:t,frameLoaded:we})):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"top"},l.a.createElement("div",{className:"header"},J.sections&&l.a.createElement("h1",null,J.sections[Z])),l.a.createElement("div",{className:"wrapper",onClick:function(){te(!ee)}},ee?l.a.createElement(d.a,{width:"48"}):l.a.createElement(u.a,{width:"48"}))),l.a.createElement("div",{className:"inner"},J.sections&&Object.values(J[I]||{}).map((function(e,t){return l.a.createElement(G,{key:"inner-entry-"+t,entry:e,setShowingEdit:ge,setShowingNew:te,setNewAudio:Ie,setNewImages:Oe,setNewFiles:Te,setNewDate:de,setAdditionalDate:He,setNewTitle:oe,setNewText:le,setShowingDeleteDialog:Ee,projectName:i,sectionName:I,setRteInitTitle:Fe,setRteInitContent:_e,setShowingAdditionalDate:We})}))))),l.a.createElement("div",{className:"overlay "+(ee?"showing":""),onClick:function(){st()}}),l.a.createElement("div",{className:"modal "+(ee?"showing":"")},l.a.createElement("div",{className:"title"},l.a.createElement("div",null,l.a.createElement(d.a,{onClick:function(){st()}}),J.sections?he?l.a.createElement("h1",null,"Edit ",I.toString().toLowerCase()):l.a.createElement("h1",null,"Create ",I.toString().toLowerCase()):""),l.a.createElement("div",null,l.a.createElement("div",{className:"save ok",onClick:function(){ct()}},l.a.createElement("span",null,"Save")))),l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"media-upload-wrapper"},l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"image-upload"},l.a.createElement("div",{className:"image-upload-wrapper"},l.a.createElement(m.a,null))),l.a.createElement("input",{id:"image-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("image added: ",t),t&&e.target.files.length&&Oe([].concat(je||[],[{id:Date.now().toString(),url:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:"image/*",onClick:function(e){e.target.value=""}})),l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"audio-upload"},l.a.createElement("div",{className:"audio-upload-wrapper"},l.a.createElement(p.a,null))),l.a.createElement("input",{id:"audio-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("audio added: ",t),t&&e.target.files.length&&Ie([].concat(Ue||[],[{id:Date.now().toString(),url:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:".mp3,.aif,.aiff,.ogg,.wav,audio/*",onClick:function(e){e.target.value=""}})),l.a.createElement("label",{htmlFor:"file-upload"},l.a.createElement("div",{className:"file-upload-wrapper"},l.a.createElement(f.a,null))),l.a.createElement("input",{id:"file-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("file added: ",t),t&&e.target.files.length&&Te([].concat(De||[],[{id:Date.now().toString(),downloadUrl:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:"application/pdf,application/msword,text/plain,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onClick:function(e){e.target.value=""}})),l.a.createElement("div",{className:"uploaded-previews box"},je&&je.length?l.a.createElement("div",null,je.map((function(e,t){return l.a.createElement("div",{className:"uploaded-img-wrapper",key:"img-"+t},l.a.createElement(S.LazyLoadImage,{className:"uploaded-img",src:e.url,effect:"blur",alt:""}),l.a.createElement("div",{onClick:function(){var t;t=e.url,dt("image",t),Oe(je.filter((function(e){return e.url!==t})))}},l.a.createElement(d.a,null)))}))):"",Ue&&Ue.length?l.a.createElement("div",null,Ue.map((function(e,t){return l.a.createElement("div",{className:"uploaded-audio-wrapper",key:"audio-"+t},l.a.createElement("audio",{controls:!0,className:"uploaded-audio",src:e.url,type:".mp3,audio/*"}),l.a.createElement("div",{onClick:function(){var t;t=e.url,dt("audio",t),Ie(Ue.filter((function(e){return e.url!==t})))}},l.a.createElement(d.a,null)))}))):"",De&&De.length?l.a.createElement("div",null,De.map((function(e,t){return l.a.createElement("div",{className:"uploaded-miscellaneous-wrapper",key:"miscellaneous-"+t},l.a.createElement("div",null,l.a.createElement("a",{href:e.downloadUrl||e.url,download:e.name},e.name)),l.a.createElement("div",{onClick:function(){return t=e.url,console.log("removing fileId: ",t),console.log("newFiles: ",De),dt("miscellaneous",t),void Te(De.filter((function(e){return e.url!==t})));var t}},l.a.createElement(d.a,null)))}))):""),l.a.createElement("div",{className:"box"},l.a.createElement("div",{className:"date-wrapper"},l.a.createElement("h4",null,"Date"),l.a.createElement("div",{className:"svg-wrapper",onClick:function(){We(!Ve)}},l.a.createElement("label",null,"Using a date range"),l.a.createElement("div",{className:"svg-wrapper-inner "+(Ve?"showing":"")},Ve?l.a.createElement(h.a,null):l.a.createElement(g.a,null)))),l.a.createElement(L.a,{onChange:function(e){de(e)},selected:se,dateFormat:"yyyy-MM-dd"}),Ve&&l.a.createElement("div",{id:"additional-datepicker"},l.a.createElement(L.a,{onChange:function(e){He(e)},selected:Ke,dateFormat:"yyyy-MM-dd"}))),l.a.createElement("div",{className:"title-upload box"},l.a.createElement("h4",null,"Title"),l.a.createElement(B,{initialValue:qe,value:w.a.createValueFromString(re,"html"),onChange:function(e){oe(e)}})),l.a.createElement("div",{className:"text-upload box"},l.a.createElement("h4",null,"Content"),l.a.createElement(B,{initialValue:Me,value:w.a.createValueFromString(ae,"html"),onChange:function(e){le(e)},files:De}))),l.a.createElement(_,{loading:me})),l.a.createElement("div",{className:"overlay "+(be?"showing":""),onClick:function(){Ee(!1)}}),l.a.createElement("div",{className:"deleteDialog "+(be?"showing":"")},l.a.createElement("h4",null,"Are you sure you want to delete this?"),l.a.createElement("div",{className:"options-wrapper"},l.a.createElement("div",{className:"cancel",onClick:function(){Ee(!1)}},l.a.createElement("span",null,"Cancel")),l.a.createElement("div",{className:"ok",onClick:function(){!function(e,n,a){if(je.length)for(var l,i=A(je);!(l=i()).done;){var o=l.value;dt("image",o.downloadUrl)}if(Ue.length)for(var c,s=A(Ue);!(c=s()).done;){o=c.value;dt("audio",o.downloadUrl)}if(De.length)for(var d,u=A(De);!(d=u()).done;){o=d.value;dt("miscellaneous",o.downloadUrl)}if(e.images&&e.images.length)for(var m,p=A(e.images);!(m=p()).done;){o=m.value;dt("image",o.url)}if(e.audio&&e.audio.length)for(var f,h=A(e.audio);!(f=h()).done;){o=f.value;dt("audio",o.url)}if(e.files&&e.files.length)for(var g,v=A(e.files);!(g=v()).done;){o=g.value;dt("miscellaneous",o.url)}t.collection(r).doc(n).collection(a).doc(e.id).delete().then((function(){})).catch((function(e){console.error("Error deleting entry: ",e)}))}(be,i,I),Ee(!1)}},l.a.createElement("span",null,"Ok"))))))};n(323),n(324),n(325),n(326);c.a.initializeApp({apiKey:"AIzaSyBiw4ORAbMmxImx4qPGq9JAFtUI36PeYQ0",authDomain:"sheets2website-1598313088115.firebaseapp.com",databaseURL:"https://sheets2website-1598313088115.firebaseio.com",projectId:"sheets2website-1598313088115",storageBucket:"sheets2website-1598313088115.appspot.com",messagingSenderId:"1082271392691",appId:"1:1082271392691:web:45c06be046a0a72b5b21c6",measurementId:"G-ZWGE5NLZ4Z"});var Y=c.a.firestore(),Q=function(e){var t=e.db,n=Object(a.useState)({name:"Jason",surname:"Briggs",description:"This is a paragraph that can be changed by pressing the edit button on the bottom right.",jobs:["Software Engineer","Automation Tester","Developer Operations","Marketing & Sales Coordinator","Test Analyst"],careers:[{title:"Automation Testing",duration:2},{title:"Junior Software Developer",duration:5},{title:"Senior Software Developer",duration:10}],details:{volunteer_work:"Working at the Orphanage",qualifications1:"Google Ads Master - 2020",qualifications2:"Google Ads Master - 2021",qualifications3:{text:"2019 Kickstart Coding Challenge - Bronze",start:"2019 Jan",end:"2019 Nov"}}}),i=Object(o.a)(n,2),r=i[0],c=i[1];return Object(a.useEffect)((function(){t.collection("CMS_WebsiteContent").doc("test").get().then((function(e){c(e.data())}))}),[t]),l.a.createElement("div",null,l.a.createElement("h4",null,"This is a CMS sample, on the left is the CMS, and this is an example website."),l.a.createElement("h2",null,"This header cannot be edited."),l.a.createElement("p",{id:"description",className:"cp-editable"},r.description),l.a.createElement("div",{style:{padding:"15px",margin:"auto"}},l.a.createElement("div",{id:"name",className:"cp-editable"},r.name),l.a.createElement("div",{id:"surname",className:"cp-editable"},r.surname)),l.a.createElement("p",null,"This paragraph cannot be edited because it doesn't have the className 'cp-editable', or an id to be linked to the object in the Firstore database. If you look at the example source code you'll see what can be edited and what can't."),l.a.createElement("h4",null,"List of jobs"),l.a.createElement("ul",null,r.jobs.map((function(e,t){return l.a.createElement("li",{id:"jobs-"+t,className:"cp-editable",style:{lineHeight:"2"}},e)}))),l.a.createElement("h4",null,"Careers"),l.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap"}},r.careers.map((function(e,t){return l.a.createElement("div",{style:{padding:"5px",margin:"15px 5px",borderRadius:"4px",border:"2px solid rgb(0,0,0,0.15)",backgroundColor:"rgb(245,245,245)"}},l.a.createElement("div",{id:"careers-"+t+"-title",className:"cp-editable",style:{margin:"10px 0"}},"Position: ",e.title),l.a.createElement("div",{id:"careers-"+t+"-duration",className:"cp-editable"},"Duration: ",e.duration," years"))})),l.a.createElement("div",null,l.a.createElement("div",{id:"details-volunteer_work",className:"cp-editable"},"Activity: ",r.details.volunteer_work),l.a.createElement("div",{id:"details-qualifications1",className:"cp-editable"},"Qualification: ",r.details.qualifications1),l.a.createElement("div",{id:"details-qualifications2",className:"cp-editable"},"Qualification: ",r.details.qualifications2),l.a.createElement("div",null,l.a.createElement("p",null,"This is a deep component with multiple children"),l.a.createElement("div",{id:"details-qualifications3-text",className:"cp-editable"},"Qualification: ",r.details.qualifications3.text),l.a.createElement("div",{id:"details-qualifications3-start",className:"cp-editable"},"Start: ",r.details.qualifications3.start),l.a.createElement("div",{id:"details-qualifications3-end",className:"cp-editable"},"End: ",r.details.qualifications3.end)))))},Z=function(){return l.a.createElement(J,{projectName:"test",children:l.a.createElement(Q,{db:Y}),db:Y,firebase:c.a,collectionName:"CMS",collectionWebsiteContent:"CMS_WebsiteContent"})};r.a.render(l.a.createElement(Z,null),document.getElementById("root"))}},[[150,1,2]]]);
//# sourceMappingURL=main.d555d133.chunk.js.map