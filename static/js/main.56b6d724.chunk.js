(this["webpackJsonpreact-firestore-cms-example"]=this["webpackJsonpreact-firestore-cms-example"]||[]).push([[0],{161:function(e,t,a){e.exports=a(340)},168:function(e,t,a){},333:function(e,t,a){},334:function(e,t,a){},335:function(e,t,a){},336:function(e,t,a){},340:function(e,t,a){"use strict";a.r(t);var n=a(2),l=a.n(n),i=a(33),r=a.n(i),c=a(11),o=(a(168),a(77)),s=a(43),u=a(78),d=a(34),m=a(17),p=a.n(m),f=a(26),b=a(150),g=a(151),h=a(160),v=a(159),E=a(152),w=a(343),y=a(344),N=a(345),O=a(346),j=a(347),k=a(348),C=a(349),S=a(350),x=a(351),L=a(352),D=a(44),T=a.n(D),U=a(98),I=a(58),q=a(99),F=a.n(q),A=(a(269),a(155)),R=a.n(A),M=a(156),_=a.n(M),B=a(76),P=a.n(B);function V(e){var t=e.loading;e.loadingTexts;return l.a.createElement("div",null,l.a.createElement("div",{className:"Loading "+(t?"show":"")},l.a.createElement("div",{className:"double-bounce1"}),l.a.createElement("div",{className:"double-bounce2"})),l.a.createElement("div",{className:"Loading-overlay "+(t?"show":"")}))}var W=function(e){Object(h.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(e=t.call.apply(t,[this].concat(l))).editorValue=T.a.createEmptyValue(),e.state={value:e.editorValue,files:e.props.files,showDropdown:!1},e.onChange=function(t){e.setState({value:t}),e.props.onChange&&e.props.onChange(t.toString("html"))},e}return Object(g.a)(a,[{key:"componentDidUpdate",value:function(e,t,a){this.props.initialValue!==e.initialValue&&this.setState({value:T.a.createValueFromString(this.props.initialValue,"html")})}},{key:"render",value:function(){var e=this;return l.a.createElement(T.a,{value:this.state.value,onChange:this.onChange,toolbarConfig:{display:["INLINE_STYLE_BUTTONS","BLOCK_TYPE_BUTTONS","BLOCK_TYPE_DROPDOWN","LINK_BUTTONS"],INLINE_STYLE_BUTTONS:[{label:"Bold",style:"BOLD",className:"custom-css-class"},{label:"Italic",style:"ITALIC"},{label:"Underline",style:"UNDERLINE"}],BLOCK_TYPE_DROPDOWN:[{label:"Normal",style:"unstyled"},{label:"Small Title",style:"header-three"},{label:"Medium Title",style:"header-two"},{label:"Large Title",style:"header-one"}],BLOCK_TYPE_BUTTONS:[{label:"UL",style:"unordered-list-item"},{label:"OL",style:"ordered-list-item"}]},customControls:[function(t,a,n){return e.props.files?l.a.createElement("div",{className:"link-file",onClick:function(){console.log("Link to file clicked: ",e.props.files),e.setState({showDropdown:!e.state.showDropdown})},style:{display:e.props.files.length?"inline-block":"none"}},e.state.showDropdown?l.a.createElement(w.a,null):"Link to a file",l.a.createElement("div",{className:"link-file-dropdown "+(e.state.showDropdown?"showing":"")},e.props.files.map((function(t,a){return l.a.createElement("div",{key:"link-file-"+a,onClick:function(){console.log("file selected: ",t);n.getSelection().getAnchorKey();var a=n.getCurrentContent().createEntity("LINK","MUTABLE",{url:"file:".concat(t.id),class:"file-link"}),l=a.getLastCreatedEntityKey(),i=U.EditorState.set(n,{currentContent:a}),r=new D.EditorValue(U.RichUtils.toggleLink(i,i.getSelection(),l,"html"));e.setState({value:r}),e.props.onChange(r.toString("html"))}},l.a.createElement("span",null,t.name))})))):""}]})}}]),a}(l.a.Component),z=function(e){return e&&e.seconds?new Date(1e3*e.seconds).toLocaleDateString("en-nz"):""},K="https://firebasestorage.googleapis.com";function H(e){var t=e.children,a=e.setFrameLoaded,i=Object(n.useState)(),r=Object(c.a)(i,2);r[0],r[1];return Object(n.useEffect)((function(){}),[]),l.a.createElement(R.a,{id:"editingFrame",height:"100%",width:"100%",contentDidMount:function(){a(!0)}},t)}var G={};function J(e){var t=e.projectName,a=e.collectionWebsiteContent,i=e.db,r=e.frameLoaded;Object(n.useEffect)((function(){if(r){E();var e=setInterval((function(){o()}),1500),t=c().head,a=c().createElement("link");return a.type="text/css",a.rel="stylesheet",a.href="https://cdn.quilljs.com/1.3.6/quill.snow.css",t.appendChild(a),function(){t.removeChild(a),console.log("CLEARING INTERVAL"),clearInterval(e)}}}),[r]);var c=function(){var e=document.querySelector("#editingFrame");if(e)return e.contentDocument},o=function(){for(var e=0,t=Array.from(c().querySelectorAll(".cp-editable"));e<t.length;e++){var a=t[e];if(!a.querySelector(".cp-editable-btn")){var n=c().createElement("div");n.classList.add("cp-editable-btn-wrapper");var l=c().createElement("div"),i=c().createElement("div");l.textContent="Edit",l.classList.add("cp-editable-btn"),i.classList.add("editor");var r=c().createElement("div");r.textContent="Save",r.classList.add("cp-editable-save-btn");var o=c().createElement("div");o.textContent="Cancel",o.classList.add("cp-editable-cancel-btn"),r.onclick=function(e){u(e)},o.onclick=function(e){s()},l.onclick=function(e){v(e)},a.appendChild(i),n.appendChild(l),n.appendChild(r),n.appendChild(o),a.appendChild(n)}}},s=function(e){var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),console.log("Cancel pressed"),console.log(G[P()(t)].getText()),t.querySelector(".ql-toolbar").style.display="none",t.querySelector(".ql-container").style.display="none",t.textContent=G[P()(t)].getText(),console.log("parentElement.textContent: ",t.textContent)},u=function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n,l,i,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=t.target.closest(".cp-editable")).classList.toggle("editing"),n=c().querySelector(".ql-editor").textContent,console.log("got text: ",n),a.textContent=n,e.next=7,m();case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0={};case 10:return l=e.t0,console.log("Loaded dbObj: ",l),i=a.id.split(/-|~/g),console.log("el.id: ",a.id),console.log("sections: ",i),r=g(a),d(l,i,r),console.log("Returned: ",l),e.next=20,b(l);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d=function e(t,a,n){if(1!==a.length)return e(t[a[0]],a.slice(1),n);t[a]=n},m=function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.collection(a).doc(t).get().then((function(e){return console.log(e.data()),e.data()})).catch((function(e){return console.error("Error loading website content: ",e)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Object(f.a)(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.collection(a).doc(t).set(n).then((function(){return"Success"})).catch((function(e){return console.error("Error saving website content: ",e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){return console.log("Extracting text from: ",e,e.textContent),e.textContent.replace(/EditSaveCancel/,"")},h=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]],v=function(e){console.log("Creating edit input");var t=e.target.closest(".cp-editable");t.classList.toggle("editing"),console.log("parentElement: ",t);var a=t.innerHTML.match(/^[^<]*/),n=a[0].trim(),l=new RegExp(a[0]);if(t.querySelector(".ql-toolbar"))t.querySelector(".ql-toolbar").style.display="block",t.querySelector(".ql-container").style.display="block",t.innerHTML=t.innerHTML.replace(l,"");else{var i=new _.a(t.querySelector(".editor"),{modules:{toolbar:h},theme:"snow"});i.setText(n),t.innerHTML=t.innerHTML.replace(l,""),G[P()(t)]=i}t.querySelector(".cp-editable-cancel-btn").onclick=function(e){s(e)},t.querySelector(".cp-editable-save-btn").onclick=function(e){u(e)}},E=function(){o(),c().head.insertAdjacentHTML("beforeend",'\n            <style>\n                .cp-editable {\n                    border: 2px solid black;\n                    position: relative;\n                }\n                .cp-editable::after {\n                    content: "";\n                    background-color: rgba(0,0,0,0.1);\n                    position: absolute;\n                    bottom: 0;\n                    top: 0;\n                    left: 0;\n                    right: 0;\n                    pointer-events: none;\n                }\n                .cp-editable.editing::after {\n                    opacity: 0;\n                }\n                .cp-editable-btn-wrapper {\n                    position: absolute;\n                    /* box-shadow: 0px 0px 2px rgba(255,255,255,0.5); */\n                    z-index: 1;\n                    right: 0;\n                    bottom: -5px;\n                    display: flex;\n                    justify-content: space-evenly;\n                    align-items: center;\n                    transition: all 100ms ease-in-out;\n                }\n                .cp-editable-btn,\n                .cp-editable-save-btn,\n                .cp-editable-cancel-btn {\n                    background-color: black;\n                    color: white;\n                    padding: 2px 4px;\n                    width: 50px;\n                    font-size: 12px;\n                    border-radius: 4px;\n                    border: 1px solid rgba(150,150,150,0.5);\n                    cursor: pointer;\n                    line-height: normal;\n                    font-weight: 200;\n                    margin-left: 5px;\n                }\n                .cp-editable-btn:hover,\n                .cp-editable-save-btn:hover,\n                .cp-editable-cancel-btn:hover {\n                    background-color: rgb(50,50,50);\n                }\n                .cp-editable.editing .cp-editable-btn {\n                    display: none;\n                }\n                .cp-editable .cp-editable-save-btn,\n                .cp-editable .cp-editable-cancel-btn {\n                    display: none;\n                }\n                .cp-editable.editing .cp-editable-save-btn,\n                .cp-editable.editing .cp-editable-cancel-btn {\n                    display: block;\n                }\n            </style>\n        ')};return l.a.createElement(l.a.Fragment,null)}var Y=function(e){var t=e.entry,a=(e.projectName,e.sectionName,e.setShowingEdit),n=e.setShowingNew,i=e.setNewAudio,r=e.setNewImages,c=e.setNewFiles,o=e.setNewDate,s=e.setAdditionalDate,u=e.setNewTitle,d=e.setNewText,m=e.setShowingDeleteDialog,p=e.setRteInitTitle,f=e.setRteInitContent,b=e.setShowingAdditionalDate;return l.a.createElement("div",{className:"SectionContent"},l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"cms-media-wrapper"},t.images&&t.images.length?l.a.createElement(I.LazyLoadImage,{src:t.imageURL||t.images[0].url,effect:"blur",width:"260px",height:"fit-content",alt:""}):"",t.audio&&t.audio.length?l.a.createElement("audio",{controls:!0,src:t.audioURL||t.audio[0].url,type:".mp3,audio/*"}):"",t.files&&t.files.length?l.a.createElement("div",{className:"file"},l.a.createElement(S.a,null),l.a.createElement("p",null,t.files.length," resource",t.files.length>1?"s":"")):""),l.a.createElement("div",{className:"right-content"},l.a.createElement("div",{dangerouslySetInnerHTML:{__html:t.title}}),l.a.createElement("div",{className:"date-display-container"},t.date&&l.a.createElement("p",{className:"date"},z(t.date)),t.additionalDate&&l.a.createElement("p",{className:"additionalDate"},z(t.additionalDate))),l.a.createElement("div",{className:"contents",dangerouslySetInnerHTML:{__html:t.content}}))),l.a.createElement("div",null,l.a.createElement("div",{className:"edit",onClick:function(){console.log("showing entry: ",t),a(t),n(!0),i(t.audio||[]),r(t.images||[]),c(t.files||[]),o(new Date(1e3*t.date.seconds)),t.additionalDate&&b(!0);var e=t.additionalDate?1e3*t.additionalDate.seconds:Date.now();s(new Date(e)),u(t.title||""),d(t.content||""),p(t.title||""),f(t.content||"")}},l.a.createElement(x.a,null)),l.a.createElement("div",{className:"delete",onClick:function(){m(t)}},l.a.createElement(L.a,null))))},Q=function(e){var t=e.db,a=e.firebase,i=e.projectName,r=e.collectionName,o=e.collectionWebsiteContent,m=e.children;Object(n.useEffect)((function(){}),[]);var b=Object(n.useState)(!1),g=Object(c.a)(b,2),h=g[0],v=g[1],S=Object(n.useState)(),x=Object(c.a)(S,2),L=x[0],D=x[1],U=Object(n.useState)({}),q=Object(c.a)(U,2),A=q[0],R=q[1],M=Object(n.useState)(""),_=Object(c.a)(M,2),B=_[0],P=_[1],z=Object(n.useState)(""),G=Object(c.a)(z,2),Q=G[0],Z=G[1],X=Object(n.useState)({sections:[]}),$=Object(c.a)(X,2),ee=$[0],te=$[1],ae=Object(n.useState)(0),ne=Object(c.a)(ae,2),le=ne[0],ie=ne[1],re=Object(n.useState)(!1),ce=Object(c.a)(re,2),oe=ce[0],se=ce[1],ue=Object(n.useState)(""),de=Object(c.a)(ue,2),me=de[0],pe=de[1],fe=Object(n.useState)(""),be=Object(c.a)(fe,2),ge=be[0],he=be[1],ve=Object(n.useState)(new Date),Ee=Object(c.a)(ve,2),we=Ee[0],ye=Ee[1],Ne=Object(n.useState)(!1),Oe=Object(c.a)(Ne,2),je=Oe[0],ke=Oe[1],Ce=Object(n.useState)(void 0),Se=Object(c.a)(Ce,2),xe=Se[0],Le=Se[1],De=Object(n.useState)(!1),Te=Object(c.a)(De,2),Ue=Te[0],Ie=Te[1],qe=Object(n.useState)(!1),Fe=Object(c.a)(qe,2),Ae=Fe[0],Re=Fe[1],Me=Object(n.useState)(!1),_e=Object(c.a)(Me,2),Be=_e[0],Pe=_e[1],Ve=Object(n.useState)([]),We=Object(c.a)(Ve,2),ze=We[0],Ke=We[1],He=Object(n.useState)([]),Ge=Object(c.a)(He,2),Je=Ge[0],Ye=Ge[1],Qe=Object(n.useState)([]),Ze=Object(c.a)(Qe,2),Xe=Ze[0],$e=Ze[1],et=Object(n.useState)(),tt=Object(c.a)(et,2),at=tt[0],nt=tt[1],lt=Object(n.useState)(),it=Object(c.a)(lt,2),rt=it[0],ct=it[1],ot=Object(n.useState)(!1),st=Object(c.a)(ot,2),ut=st[0],dt=st[1],mt=Object(n.useState)(new Date),pt=Object(c.a)(mt,2),ft=pt[0],bt=pt[1],gt=Object(n.useState)(0),ht=Object(c.a)(gt,2),vt=ht[0],Et=ht[1],wt=Object(n.useState)(),yt=Object(c.a)(wt,2),Nt=yt[0],Ot=yt[1];Object(n.useEffect)((function(){L||(Ot(a.storage().ref()),(new a.auth.GoogleAuthProvider).addScope("https://www.googleapis.com/auth/contacts.readonly"),a.auth().onAuthStateChanged((function(e){e?(P(e.email),R(e),v(!0),D(e.uid)):(v(!0),D(""),R(""),P(""))})),a.auth().setPersistence(a.auth.Auth.Persistence.LOCAL))}),[]);var jt=function(){var e=new a.auth.GoogleAuthProvider;a.auth().signInWithPopup(e).then((function(e){})).catch((function(e){console.error("Error signing in: ",e)}))};Object(n.useEffect)((function(){L&&(kt(),Ct())}),[h,L]);var kt=function(){t&&t.collection(r).doc(i).set({lastLogin:a.firestore.FieldValue.serverTimestamp()},{merge:!0}).then((function(e){})).catch((function(e){console.error("Error in authTest: ",e),a.auth().signOut()}))},Ct=function(){St().then((function(e){e||!h?(te(e||{sections:[]}),Pe(e.webpageEditable),e.webpageEditable&&Et(0),Tt(e||{sections:[]}).then((function(e){})),e&&e.sections.length&&Z(e.sections[0]||"")):a.auth().signOut()}))},St=function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&L&&h){e.next=2;break}return e.abrupt("return",{sections:[]});case 2:return e.abrupt("return",t.collection(r).doc(i).get().then((function(e){e.get("email");return e.data()||{sections:[]}})).catch((function(e){console.error("Error reading user data: ",e)})));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xt=Object(n.useCallback)((function(){Dt({})}),[]),Lt=Object(n.useState)(),Dt=Object(c.a)(Lt,2)[1],Tt=function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.sections){e.next=2;break}return e.abrupt("return");case 2:return a=[],n={},t.sections.forEach((function(e){a.push(Ut(e,t).then((function(t){n[e]=t})))})),e.abrupt("return",Promise.all(a).then((function(){return n})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ut=function(){var e=Object(f.a)(p.a.mark((function e(a,n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.collection(r).doc(i).collection(a).orderBy("date","desc").onSnapshot((function(e){e.docChanges().forEach((function(e){var t=n;if(t[a]||(t[a]={}),"added"===e.type||"modified"===e.type){var l=e.doc.data();l.imageURL&&(l.images=[{id:Date.now().toString(),url:l.imageURL,path:"",name:""}]),l.audioURL&&(l.audio=[{id:Date.now().toString(),url:l.audioURL,name:"",path:""}]),t[a][e.doc.id]=Object(d.a)(Object(d.a)({},l),{},{id:e.doc.id})}else"removed"===e.type&&delete t[a][e.doc.id];te(t),xt()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),It=function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.localFile){e.next=2;break}return e.abrupt("return",{url:t.url,path:t.path});case 2:return a={customMetadata:{uploader:B}},n=At("images",t.name),l=Nt.child(n),e.abrupt("return",l.put(t.localFile,a).then((function(e){return console.log("Uploaded Image"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qt=function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.localFile){e.next=2;break}return e.abrupt("return",{url:t.url,path:t.path});case 2:return a={customMetadata:{uploader:B}},n=At("audio",t.name),l=Nt.child(n),e.abrupt("return",l.put(t.localFile,a).then((function(e){return console.log("Uploaded Audio"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})).catch((function(e){console.error("Error saving audio: ",e)})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ft=function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.localFile){e.next=2;break}return e.abrupt("return",{url:t.url,path:t.path});case 2:return a={customMetadata:{uploader:B}},n=At("miscellaneous",t.name),console.log("saving fileObj: ",t),l=Nt.child(n),e.abrupt("return",l.put(t.localFile,a).then((function(e){return console.log("Uploaded miscellaneous"),e.ref.getDownloadURL().then((function(e){return{url:e,path:n}}))})).catch((function(e){console.error("Error saving miscellaneous: ",e)})));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),At=function(e,t){return i+"/"+e+"/"+t},Rt=function(){var e=Object(f.a)(p.a.mark((function e(){var n,l,c,o,s,u,m,f,b,g;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ke(!0),nt("_"),ct("_"),n=ee.sections[le],l=[],c=0;case 6:if(!(c<ze.length)){e.next=19;break}if(!(ze[c].downloadUrl||"").includes(K)){e.next=11;break}e.t0=ze[c],e.next=14;break;case 11:return e.next=13,It(ze[c]);case 13:e.t0=e.sent;case 14:o=e.t0,l.push(Object(d.a)(Object(d.a)({},o),{},{id:ze[c].id,name:ze[c].name}));case 16:c++,e.next=6;break;case 19:s=[],c=0;case 21:if(!(c<Xe.length)){e.next=34;break}if(!(Xe[c].downloadUrl||"").includes(K)){e.next=26;break}e.t1=Xe[c],e.next=29;break;case 26:return e.next=28,qt(Xe[c]);case 28:e.t1=e.sent;case 29:u=e.t1,s.push(Object(d.a)(Object(d.a)({},u),{},{id:Xe[c].id,name:Xe[c].name}));case 31:c++,e.next=21;break;case 34:m=[],c=0;case 36:if(!(c<Je.length)){e.next=49;break}if(!(Je[c].downloadUrl||"").includes(K)){e.next=41;break}e.t2=Je[c],e.next=44;break;case 41:return e.next=43,Ft(Je[c]);case 43:e.t2=e.sent;case 44:f=e.t2,m.push(Object(d.a)(Object(d.a)({},f),{},{id:Je[c].id,name:Je[c].name}));case 46:c++,e.next=36;break;case 49:(b={}).images=l||[],b.audio=s||[],b.files=m||[],ge&&(b.title=ge),me&&(b.content=me),b.date=we||(new Date).toLocaleDateString("en-CA").toString(),b.additionalDate=ut&&ft?ft:"",b.createdOn=a.firestore.FieldValue.serverTimestamp(),g=xe?xe.id:Date.now().toString(),t.collection(r).doc(i).collection(n).doc(g).set(b,{merge:!0}).then((function(){console.log("Successfully saved entry"),ke(!1),se(!1),Le(void 0),nt(""),ct(""),he(""),pe(""),ye(new Date),bt(new Date),$e([]),Ke([]),Ye([]),dt(!1)})).catch((function(e){console.error("Error saving new entry: ",e),ke(!1),se(!1)}));case 60:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Mt=function(){Le(void 0),se(!oe),$e([]),Ke([]),ye(new Date),Ye([]),bt(new Date),he(""),dt(!1),pe(""),nt(""),ct("")},_t=function(e,t){(t||"").includes(K)&&a.storage().refFromURL(t).delete().then((function(){})).catch((function(e){console.error("Error deleting stored item")}))};return l.a.createElement("div",{className:"CMS"},l.a.createElement(E.a,null,l.a.createElement("meta",{charSet:"utf-8"}),l.a.createElement("title",null,"Update your website"),l.a.createElement("link",{rel:"icon",type:"image/png",href:"blank.ico",sizes:"16x16"})),!L&&h&&l.a.createElement("div",{className:"overlay"},l.a.createElement("div",{className:"content"},l.a.createElement("h2",null,"Login to update your website"),l.a.createElement("p",null,"Please use your approved email address"),l.a.createElement("div",{className:"login",onClick:function(){jt()}},l.a.createElement("span",null,"Login")))),l.a.createElement("div",{className:"inner"},l.a.createElement("div",{className:"left"},l.a.createElement("div",{className:"title"},l.a.createElement("h4",{className:"subtitle"},"Website Content Management"),l.a.createElement("h1",null,ee.projectName)),Be?l.a.createElement("div",{className:"editType-wrapper "+(0===vt?"left-selected":"right-selected")},l.a.createElement("div",{className:0===vt?"selected":"",onClick:function(){return Et(0)}},"Page Content"),l.a.createElement("div",{className:1===vt?"selected":"",onClick:function(){return Et(1)}},"Dynamic Content")):"",0===vt?l.a.createElement("div",{className:"sections-wrapper"},l.a.createElement("div",{className:"section",style:{backgroundColor:"white"}},"Select text on the right to edit it.")):l.a.createElement("div",{className:"sections-wrapper"},ee.sections&&ee.sections.map((function(e,t){return l.a.createElement("div",{key:"left-section-"+t,className:"section "+(le===t?"selected":""),onClick:function(){!function(e){Z(ee.sections[e]),ie(e)}(t)}},e)}))),l.a.createElement("div",{className:"profile"},A.photoURL?l.a.createElement(I.LazyLoadImage,{src:A.photoURL,effect:"blur",alt:""}):l.a.createElement(I.LazyLoadImage,{src:"profile~FlXvJqZg.png",effect:"blur",alt:""}),l.a.createElement("div",{className:"details-wrapper"},A.displayName?l.a.createElement("div",{className:"displayName"},l.a.createElement("span",null,A.displayName)):l.a.createElement("div",{onClick:function(){jt()}}),A.email?l.a.createElement("div",{className:"email"},l.a.createElement("span",null,A.email)):l.a.createElement("div",null)),A?l.a.createElement(w.a,{onClick:function(){a.auth().signOut()}}):""),l.a.createElement("div",{className:"attribution"},l.a.createElement("span",null,"Website content management - Webbi\xa9 2020"))),l.a.createElement("div",{className:"right"},0===vt?l.a.createElement(H,{setFrameLoaded:Re},m,l.a.createElement(J,{projectName:i,collectionWebsiteContent:o,db:t,frameLoaded:Ae})):l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"top"},l.a.createElement("div",{className:"header"},ee.sections&&l.a.createElement("h1",null,ee.sections[le])),l.a.createElement("div",{className:"wrapper",onClick:function(){se(!oe)}},oe?l.a.createElement(w.a,{width:"48"}):l.a.createElement(y.a,{width:"48"}))),l.a.createElement("div",{className:"inner"},ee.sections&&Object.values(ee[Q]||{}).map((function(e,t){return l.a.createElement(Y,{key:"inner-entry-"+t,entry:e,setShowingEdit:Le,setShowingNew:se,setNewAudio:$e,setNewImages:Ke,setNewFiles:Ye,setNewDate:ye,setAdditionalDate:bt,setNewTitle:he,setNewText:pe,setShowingDeleteDialog:Ie,projectName:i,sectionName:Q,setRteInitTitle:nt,setRteInitContent:ct,setShowingAdditionalDate:dt})}))))),l.a.createElement("div",{className:"overlay "+(oe?"showing":""),onClick:function(){Mt()}}),l.a.createElement("div",{className:"modal "+(oe?"showing":"")},l.a.createElement("div",{className:"title"},l.a.createElement("div",null,l.a.createElement(w.a,{onClick:function(){Mt()}}),ee.sections?xe?l.a.createElement("h1",null,"Edit ",Q.toString().toLowerCase()):l.a.createElement("h1",null,"Create ",Q.toString().toLowerCase()):""),l.a.createElement("div",null,l.a.createElement("div",{className:"save ok",onClick:function(){Rt()}},l.a.createElement("span",null,"Save")))),l.a.createElement("div",{className:"content"},l.a.createElement("div",{className:"media-upload-wrapper"},l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"image-upload"},l.a.createElement("div",{className:"image-upload-wrapper"},l.a.createElement(N.a,null))),l.a.createElement("input",{id:"image-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("image added: ",t),t&&e.target.files.length&&Ke([].concat(Object(u.a)(ze||[]),[{id:Date.now().toString(),url:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:"image/*",onClick:function(e){e.target.value=""}})),l.a.createElement(l.a.Fragment,null,l.a.createElement("label",{htmlFor:"audio-upload"},l.a.createElement("div",{className:"audio-upload-wrapper"},l.a.createElement(O.a,null))),l.a.createElement("input",{id:"audio-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("audio added: ",t),t&&e.target.files.length&&$e([].concat(Object(u.a)(Xe||[]),[{id:Date.now().toString(),url:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:".mp3,.aif,.aiff,.ogg,.wav,audio/*",onClick:function(e){e.target.value=""}})),l.a.createElement("label",{htmlFor:"file-upload"},l.a.createElement("div",{className:"file-upload-wrapper"},l.a.createElement(j.a,null))),l.a.createElement("input",{id:"file-upload",type:"file",onChange:function(e){var t=e.target.files[0];console.log("file added: ",t),t&&e.target.files.length&&Ye([].concat(Object(u.a)(Je||[]),[{id:Date.now().toString(),downloadUrl:URL.createObjectURL(t),name:t.name,localFile:t}]))},hidden:!0,accept:"application/pdf,application/msword,text/plain,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onClick:function(e){e.target.value=""}})),l.a.createElement("div",{className:"uploaded-previews box"},ze&&ze.length?l.a.createElement("div",null,ze.map((function(e,t){return l.a.createElement("div",{className:"uploaded-img-wrapper",key:"img-"+t},l.a.createElement(I.LazyLoadImage,{className:"uploaded-img",src:e.url,effect:"blur",alt:""}),l.a.createElement("div",{onClick:function(){var t;t=e.url,_t("image",t),Ke(ze.filter((function(e){return e.url!==t})))}},l.a.createElement(w.a,null)))}))):"",Xe&&Xe.length?l.a.createElement("div",null,Xe.map((function(e,t){return l.a.createElement("div",{className:"uploaded-audio-wrapper",key:"audio-"+t},l.a.createElement("audio",{controls:!0,className:"uploaded-audio",src:e.url,type:".mp3,audio/*"}),l.a.createElement("div",{onClick:function(){var t;t=e.url,_t("audio",t),$e(Xe.filter((function(e){return e.url!==t})))}},l.a.createElement(w.a,null)))}))):"",Je&&Je.length?l.a.createElement("div",null,Je.map((function(e,t){return l.a.createElement("div",{className:"uploaded-miscellaneous-wrapper",key:"miscellaneous-"+t},l.a.createElement("div",null,l.a.createElement("a",{href:e.downloadUrl||e.url,download:e.name},e.name)),l.a.createElement("div",{onClick:function(){return t=e.url,console.log("removing fileId: ",t),console.log("newFiles: ",Je),_t("miscellaneous",t),void Ye(Je.filter((function(e){return e.url!==t})));var t}},l.a.createElement(w.a,null)))}))):""),l.a.createElement("div",{className:"box"},l.a.createElement("div",{className:"date-wrapper"},l.a.createElement("h4",null,"Date"),l.a.createElement("div",{className:"svg-wrapper",onClick:function(){dt(!ut)}},l.a.createElement("label",null,"Using a date range"),l.a.createElement("div",{className:"svg-wrapper-inner "+(ut?"showing":"")},ut?l.a.createElement(k.a,null):l.a.createElement(C.a,null)))),l.a.createElement(F.a,{onChange:function(e){ye(e)},selected:we,dateFormat:"yyyy-MM-dd"}),ut&&l.a.createElement("div",{id:"additional-datepicker"},l.a.createElement(F.a,{onChange:function(e){bt(e)},selected:ft,dateFormat:"yyyy-MM-dd"}))),l.a.createElement("div",{className:"title-upload box"},l.a.createElement("h4",null,"Title"),l.a.createElement(W,{initialValue:at,value:T.a.createValueFromString(ge,"html"),onChange:function(e){he(e)}})),l.a.createElement("div",{className:"text-upload box"},l.a.createElement("h4",null,"Content"),l.a.createElement(W,{initialValue:rt,value:T.a.createValueFromString(me,"html"),onChange:function(e){pe(e)},files:Je}))),l.a.createElement(V,{loading:je})),l.a.createElement("div",{className:"overlay "+(Ue?"showing":""),onClick:function(){Ie(!1)}}),l.a.createElement("div",{className:"deleteDialog "+(Ue?"showing":"")},l.a.createElement("h4",null,"Are you sure you want to delete this?"),l.a.createElement("div",{className:"options-wrapper"},l.a.createElement("div",{className:"cancel",onClick:function(){Ie(!1)}},l.a.createElement("span",null,"Cancel")),l.a.createElement("div",{className:"ok",onClick:function(){!function(e,a,n){if(ze.length){var l,i=Object(s.a)(ze);try{for(i.s();!(l=i.n()).done;){var c=l.value;_t("image",c.downloadUrl)}}catch(E){i.e(E)}finally{i.f()}}if(Xe.length){var o,u=Object(s.a)(Xe);try{for(u.s();!(o=u.n()).done;){c=o.value;_t("audio",c.downloadUrl)}}catch(E){u.e(E)}finally{u.f()}}if(Je.length){var d,m=Object(s.a)(Je);try{for(m.s();!(d=m.n()).done;){c=d.value;_t("miscellaneous",c.downloadUrl)}}catch(E){m.e(E)}finally{m.f()}}if(e.images&&e.images.length){var p,f=Object(s.a)(e.images);try{for(f.s();!(p=f.n()).done;){c=p.value;_t("image",c.url)}}catch(E){f.e(E)}finally{f.f()}}if(e.audio&&e.audio.length){var b,g=Object(s.a)(e.audio);try{for(g.s();!(b=g.n()).done;){c=b.value;_t("audio",c.url)}}catch(E){g.e(E)}finally{g.f()}}if(e.files&&e.files.length){var h,v=Object(s.a)(e.files);try{for(v.s();!(h=v.n()).done;){c=h.value;_t("miscellaneous",c.url)}}catch(E){v.e(E)}finally{v.f()}}t.collection(r).doc(a).collection(n).doc(e.id).delete().then((function(){})).catch((function(e){console.error("Error deleting entry: ",e)}))}(Ue,i,Q),Ie(!1)}},l.a.createElement("span",null,"Ok"))))))};a(333),a(334),a(335),a(336);o.a.initializeApp({apiKey:"AIzaSyBiw4ORAbMmxImx4qPGq9JAFtUI36PeYQ0",authDomain:"sheets2website-1598313088115.firebaseapp.com",databaseURL:"https://sheets2website-1598313088115.firebaseio.com",projectId:"sheets2website-1598313088115",storageBucket:"sheets2website-1598313088115.appspot.com",messagingSenderId:"1082271392691",appId:"1:1082271392691:web:45c06be046a0a72b5b21c6",measurementId:"G-ZWGE5NLZ4Z"});var Z=o.a.firestore(),X=function(e){var t=e.db,a=Object(n.useState)({name:"Jason",surname:"Briggs",description:"This is a paragraph that can be changed by pressing the edit button on the bottom right.",jobs:["Software Engineer","Automation Tester","Developer Operations","Marketing & Sales Coordinator","Test Analyst"],careers:[{title:"Automation Testing",duration:2},{title:"Junior Software Developer",duration:5},{title:"Senior Software Developer",duration:10}],details:{volunteer_work:"Working at the Orphanage",qualifications1:"Google Ads Master - 2020",qualifications2:"Google Ads Master - 2021",qualifications3:{text:"2019 Kickstart Coding Challenge - Bronze",start:"2019 Jan",end:"2019 Nov"}}}),i=Object(c.a)(a,2),r=i[0],o=i[1];return Object(n.useEffect)((function(){t.collection("CMS_WebsiteContent").doc("test").get().then((function(e){o(e.data())}))}),[t]),l.a.createElement("div",null,l.a.createElement("h4",null,"This is a CMS sample, on the left is the CMS, and this is an example website."),l.a.createElement("h2",null,"This header cannot be edited."),l.a.createElement("p",{id:"description",className:"cp-editable"},r.description),l.a.createElement("div",{style:{padding:"15px",margin:"auto"}},l.a.createElement("div",{id:"name",className:"cp-editable"},r.name),l.a.createElement("div",{id:"surname",className:"cp-editable"},r.surname)),l.a.createElement("p",null,"This paragraph cannot be edited because it doesn't have the className 'cp-editable', or an id to be linked to the object in the Firstore database. If you look at the example source code you'll see what can be edited and what can't."),l.a.createElement("h4",null,"List of jobs"),l.a.createElement("ul",null,r.jobs.map((function(e,t){return l.a.createElement("li",{id:"jobs-"+t,className:"cp-editable",style:{lineHeight:"2"}},e)}))),l.a.createElement("h4",null,"Careers"),l.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",flexWrap:"wrap"}},r.careers.map((function(e,t){return l.a.createElement("div",{style:{padding:"5px",margin:"15px 5px",borderRadius:"4px",border:"2px solid rgb(0,0,0,0.15)",backgroundColor:"rgb(245,245,245)"}},l.a.createElement("div",{id:"careers-"+t+"-title",className:"cp-editable",style:{margin:"10px 0"}},"Position: ",e.title),l.a.createElement("div",{id:"careers-"+t+"-duration",className:"cp-editable"},"Duration: ",e.duration," years"))})),l.a.createElement("div",null,l.a.createElement("div",{id:"details-volunteer_work",className:"cp-editable"},"Activity: ",r.details.volunteer_work),l.a.createElement("div",{id:"details-qualifications1",className:"cp-editable"},"Qualification: ",r.details.qualifications1),l.a.createElement("div",{id:"details-qualifications2",className:"cp-editable"},"Qualification: ",r.details.qualifications2),l.a.createElement("div",null,l.a.createElement("p",null,"This is a deep component with multiple children"),l.a.createElement("div",{id:"details-qualifications3-text",className:"cp-editable"},"Qualification: ",r.details.qualifications3.text),l.a.createElement("div",{id:"details-qualifications3-start",className:"cp-editable"},"Start: ",r.details.qualifications3.start),l.a.createElement("div",{id:"details-qualifications3-end",className:"cp-editable"},"End: ",r.details.qualifications3.end)))))},$=function(){return l.a.createElement(Q,{projectName:"test",children:l.a.createElement(X,{db:Z}),db:Z,firebase:o.a,collectionName:"CMS",collectionWebsiteContent:"CMS_WebsiteContent"})};r.a.render(l.a.createElement($,null),document.getElementById("root"))}},[[161,1,2]]]);
//# sourceMappingURL=main.56b6d724.chunk.js.map